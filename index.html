<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Jur√≠dico Completo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a, #2F5496);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 100%;
        }
        
        .header {
            text-align: center;
            padding: 25px;
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 15px 0;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border: 1px solid #eaeaea;
        }
        
        .btn {
            background: #2F5496;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 14px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            width: 100%;
            display: block;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #000;
        }
        
        .btn-info {
            background: #17a2b8;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .form-group {
            margin: 12px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2F5496;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #2F5496;
            outline: none;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .data-item {
            background: #f8fafc;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #2F5496;
            transition: transform 0.2s;
        }
        
        .data-item:hover {
            transform: translateX(5px);
        }
        
        .search-box {
            background: #e3f2fd;
            padding: 18px;
            border-radius: 10px;
            margin: 12px 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 12px 0;
        }
        
        .stat-card {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 14px;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #2F5496;
        }
        
        .processos-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 12px 0;
            justify-content: space-between;
        }
        
        .processo-card {
            background: #e8f5e8;
            padding: 12px 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 12px;
            flex: 1;
            min-width: 80px;
        }
        
        .processo-number {
            font-size: 16px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .teses-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .tese-card {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
        }
        
        .tese-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .alert {
            padding: 12px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
            width: auto;
            display: inline-block;
            margin: 2px;
        }
        
        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
        }
        
        h1, h2, h3, h4 {
            color: #1e3a8a;
        }
        
        .header h1, .header p {
            color: white;
        }
        
        .print-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: 600;
        }
        
        .print-btn:hover {
            background: #5a6268;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            body {
                background: white;
                color: black;
            }
        }

        .tese-selecao {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        /* NOVOS ESTILOS PARA LAYOUT DE CLIENTES */
        .clientes-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .clientes-container {
                grid-template-columns: 1fr;
            }
        }
        
        .lista-clientes {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .cliente-item {
            background: #f8f9fa;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border-left: 4px solid #2F5496;
            font-size: 13px;
        }
        
        .cliente-item strong {
            color: #2F5496;
            display: block;
            margin-bottom: 4px;
        }
        
        .cliente-item .detalhes {
            font-size: 12px;
            color: #666;
        }
        
        .cliente-codigo {
            background: #2F5496;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .cliente-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .total-clientes {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .total-clientes .numero {
            font-size: 24px;
            font-weight: bold;
            color: #2F5496;
        }

        /* ESTILOS PARA BOT√ÉO DE ATUALIZA√á√ÉO */
        .btn-atualizar {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            width: auto;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-atualizar:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .container-botoes {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            gap: 15px;
        }

        .botoes-direita {
            display: flex;
            gap: 10px;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <div class="header">
                <h1>‚öñÔ∏è Sistema Jur√≠dico Completo</h1>
                <p>Controle de Clientes, Processos e Teses Jur√≠dicas</p>
            </div>

            <div class="card">
                <h3>üìä Dashboard</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-clientes">0</div>
                        <p>Clientes Cadastrados</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-processos">0</div>
                        <p>Total de Processos</p>
                    </div>
                </div>

                <h4 style="margin: 15px 0 10px 0; color: #2F5496;">üìà Processos por √Årea</h4>
                <div class="processos-grid">
                    <div class="processo-card">
                        <div class="processo-number" id="processos-trabalhista">0</div>
                        <p>Trabalhista</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-civel">0</div>
                        <p>C√≠vel</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-consumidor">0</div>
                        <p>Consumidor</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-previdenciario">0</div>
                        <p>Previdenci√°rio</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-familia">0</div>
                        <p>Fam√≠lia</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-criminal">0</div>
                        <p>Criminal</p>
                    </div>
                    <div class="processo-card">
                        <div class="processo-number" id="processos-outros">0</div>
                        <p>Outros</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>üöÄ A√ß√µes R√°pidas</h3>
                <button class="btn" onclick="showTab('clientes')">üë§ Cadastrar Cliente</button>
                <button class="btn" onclick="showTab('editar-cliente')">‚úèÔ∏è Editar Cliente</button>
                <button class="btn" onclick="showTab('processos')">üìÅ Cadastrar Processo</button>
                <button class="btn" onclick="showTab('andamento')">üìù Novo Andamento</button>
                <button class="btn" onclick="showTab('consultas')">üîç Consultas</button>
                <button class="btn" onclick="showTab('relatorios')">üìä Relat√≥rios</button>
                <button class="btn btn-success" onclick="exportBackup()">üíæ Gerar Backup</button>
                <button class="btn btn-warning" onclick="importBackup()">üì• Importar Backup</button>
                <button class="btn btn-info" onclick="showTab('teses')">üìö Cadastro de Teses</button>
                <button class="btn btn-warning" onclick="executarAutoReparo()">üõ†Ô∏è Sistema de Auto-Reparo</button>
            </div>
        </div>

        <!-- Cadastro de Clientes - MODIFICADO -->
        <div id="clientes" class="tab-content">
            <div class="card">
                <h3>üë§ Cadastrar Cliente</h3>
                
                <div class="clientes-container">
                    <!-- Coluna do Formul√°rio -->
                    <div>
                        <div id="mensagem-cliente"></div>
                        <div class="form-group">
                            <label>C√≥digo do Cliente (Autom√°tico):</label>
                            <input type="text" id="cliente-codigo" readonly style="background: #f0f0f0;">
                            <small>Gerado automaticamente pelo sistema</small>
                        </div>
                        <div class="form-group">
                            <label>Nome Completo *</label>
                            <input type="text" id="cliente-nome" placeholder="Nome completo do cliente" required>
                        </div>
                        <div class="form-group">
                            <label>Sexo</label>
                            <select id="cliente-sexo">
                                <option value="">Selecione</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                                <option value="Outro">Outro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>CPF</label>
                            <input type="text" id="cliente-cpf" placeholder="000.000.000-00" oninput="formatarCPF(this)">
                        </div>
                        <div class="form-group">
                            <label>RG</label>
                            <input type="text" id="cliente-rg" placeholder="00.000.000-0" oninput="formatarRG(this)">
                        </div>
                        <div class="form-group">
                            <label>Endere√ßo Completo</label>
                            <input type="text" id="cliente-endereco" placeholder="Rua, n√∫mero, bairro, cidade">
                        </div>
                        <div class="form-group">
                            <label>Telefone</label>
                            <input type="text" id="cliente-telefone" placeholder="(11) 99999-9999">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="cliente-email" placeholder="cliente@email.com">
                        </div>
                        <div class="form-group">
                            <label>Observa√ß√µes</label>
                            <textarea id="cliente-observacoes" placeholder="Observa√ß√µes importantes..." rows="3"></textarea>
                        </div>
                        <button class="btn btn-success" id="btn-salvar-cliente" onclick="salvarCliente()">üíæ Salvar Cliente</button>
                    </div>

                    <!-- Coluna da Lista de Clientes -->
                    <div class="lista-clientes">
                        <div class="total-clientes">
                            <div class="numero" id="contador-clientes">0</div>
                            <p>Clientes Cadastrados</p>
                        </div>
                        <div id="lista-clientes-realtime">
                            <!-- Lista ser√° preenchida automaticamente -->
                        </div>
                    </div>
                </div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Editar Cliente -->
        <div id="editar-cliente" class="tab-content">
            <div class="card">
                <h3>‚úèÔ∏è Editar Cliente</h3>
                <div class="search-box">
                    <div class="form-group">
                        <label>Buscar Cliente (C√≥digo ou CPF):</label>
                        <input type="text" id="buscar-cliente-editar" placeholder="Digite c√≥digo ou CPF do cliente">
                        <button class="btn" onclick="buscarClienteEditar()" style="margin-top: 10px;">üîç Buscar Cliente</button>
                    </div>
                </div>
                
                <div id="form-editar-cliente" style="display: none;">
                    <div class="form-group">
                        <label>C√≥digo do Cliente:</label>
                        <input type="text" id="editar-codigo" readonly style="background: #f0f0f0;">
                    </div>
                    <div class="form-group">
                        <label>Nome Completo *</label>
                        <input type="text" id="editar-nome" placeholder="Nome completo do cliente" required>
                    </div>
                    <div class="form-group">
                        <label>Sexo</label>
                        <select id="editar-sexo">
                            <option value="">Selecione</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>CPF</label>
                        <input type="text" id="editar-cpf" placeholder="000.000.000-00" oninput="formatarCPF(this)">
                    </div>
                    <div class="form-group">
                        <label>RG</label>
                        <input type="text" id="editar-rg" placeholder="00.000.000-0" oninput="formatarRG(this)">
                    </div>
                    <div class="form-group">
                        <label>Endere√ßo Completo</label>
                        <input type="text" id="editar-endereco" placeholder="Rua, n√∫mero, bairro, cidade">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" id="editar-telefone" placeholder="(11) 99999-9999">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="editar-email" placeholder="cliente@email.com">
                    </div>
                    <div class="form-group">
                        <label>Observa√ß√µes</label>
                        <textarea id="editar-observacoes" placeholder="Observa√ß√µes importantes..." rows="3"></textarea>
                    </div>
                    <button class="btn btn-success" onclick="atualizarCliente()">üíæ Atualizar Cliente</button>
                </div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cadastro de Processos -->
        <div id="processos" class="tab-content">
            <div class="card">
                <h3>üìÅ Cadastrar Processo</h3>
                <div class="form-group">
                    <label>C√≥digo do Cliente *</label>
                    <input type="text" id="processo-cliente" placeholder="C√≥digo do cliente (Ex: 001)" required>
                </div>
                <div class="form-group">
                    <label>N√∫mero do Processo *</label>
                    <input type="text" id="processo-numero" placeholder="Ex: 2024.001.0001" required>
                </div>
                <div class="form-group">
                    <label>Tipo do Processo *</label>
                    <select id="processo-tipo" required>
                        <option value="">Selecione o tipo</option>
                        <option value="Trabalhista">Trabalhista</option>
                        <option value="C√≠vel">C√≠vel</option>
                        <option value="Consumidor">Consumidor</option>
                        <option value="Previdenci√°rio">Previdenci√°rio</option>
                        <option value="Fam√≠lia">Fam√≠lia</option>
                        <option value="Criminal">Criminal</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Local do Processo</label>
                    <input type="text" id="processo-local" placeholder="Ex: F√≥rum Central">
                </div>
                <div class="form-group">
                    <label>Data de In√≠cio</label>
                    <input type="date" id="processo-data">
                </div>
                <div class="form-group">
                    <label>Resumo do Processo *</label>
                    <textarea id="processo-resumo" placeholder="Descreva detalhadamente o processo, situa√ß√£o atual, andamento, pr√≥ximos passos..." rows="5" required></textarea>
                </div>
                <button class="btn btn-success" onclick="salvarProcesso()">üíæ Salvar Processo</button>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Novo Andamento Processual -->
        <div id="andamento" class="tab-content">
            <div class="card">
                <h3>üìù Novo Andamento Processual</h3>
                <div class="search-box">
                    <div class="form-group">
                        <label>Buscar Cliente (C√≥digo ou CPF):</label>
                        <input type="text" id="buscar-cliente-andamento" placeholder="Digite c√≥digo ou CPF do cliente">
                        <button class="btn" onclick="buscarClienteAndamento()" style="margin-top: 10px;">üîç Buscar Cliente</button>
                    </div>
                </div>
                
                <div id="info-cliente-andamento" style="display: none;">
                    <div class="data-item">
                        <h4>Cliente Encontrado:</h4>
                        <p id="cliente-info"></p>
                    </div>
                    
                    <div class="form-group">
                        <label>Novo Andamento/Atualiza√ß√£o:</label>
                        <textarea id="novo-andamento" placeholder="Descreva o novo andamento, atualiza√ß√µes, decis√µes judiciais, prazos, etc..." rows="6"></textarea>
                    </div>
                    
                    <button class="btn btn-success" onclick="adicionarAndamento()">‚ûï Adicionar Andamento</button>
                </div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Consultas -->
        <div id="consultas" class="tab-content">
            <div class="card">
                <h3>üîç Consultas</h3>
                
                <div class="search-box">
                    <h4>üìã Consultar Clientes</h4>
                    <div class="form-group">
                        <input type="text" id="consulta-cliente" placeholder="Digite c√≥digo, nome ou CPF...">
                    </div>
                    <button class="btn" onclick="consultarClientes()">üîç Buscar Clientes</button>
                    <button class="btn" onclick="listarTodosClientes()">üìÑ Listar Todos</button>
                </div>
                
                <div class="search-box">
                    <h4>üìÅ Consultar Processos</h4>
                    <div class="form-group">
                        <input type="text" id="consulta-processo" placeholder="Digite n√∫mero, tipo ou cliente...">
                    </div>
                    <button class="btn" onclick="consultarProcessos()">üîç Buscar Processos</button>
                    <button class="btn" onclick="listarTodosProcessos()">üìÑ Listar Todos</button>
                    <button class="btn btn-warning" onclick="consultarAndamentoProcessual()">üìà Andamento Processual</button>
                </div>
                
                <div id="resultados-consulta"></div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Relat√≥rios -->
        <div id="relatorios" class="tab-content">
            <div class="card">
                <h3>üìä Relat√≥rios</h3>
                
                <button class="btn" onclick="gerarRelatorioClientesAlfabetico()">üë§ Clientes (Ordem Alfab√©tica)</button>
                <button class="btn" onclick="gerarRelatorioClientesProcesso()">‚öñÔ∏è Clientes por Processo</button>
                
                <div class="search-box">
                    <h4>üîç Relat√≥rio Cliente Espec√≠fico</h4>
                    <div class="form-group">
                        <input type="text" id="relatorio-cliente-especifico" placeholder="Digite c√≥digo ou CPF do cliente">
                    </div>
                    <button class="btn" onclick="gerarRelatorioClienteEspecifico()">üìã Gerar Relat√≥rio</button>
                </div>
                
                <button class="btn" onclick="gerarRelatorioProcessosDetalhado()">üìÅ Processos Detalhados</button>
                <button class="btn btn-warning" onclick="gerarRelatorioAndamentoGeral()">üìà Andamento Geral</button>
                
                <div id="relatorio-conteudo"></div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cadastro de Teses Jur√≠dicas -->
        <div id="teses" class="tab-content">
            <div class="card">
                <h3>üìö Cadastro de Teses Jur√≠dicas</h3>
                
                <div class="btn-row">
                    <button class="btn btn-danger" onclick="showTab('consultar-teses')">üîç Consultar Teses Cadastradas</button>
                </div>
                
                <div class="card">
                    <h4>‚ûï Cadastrar Nova Tese</h4>
                    <div class="form-group">
                        <label>Nome da Tese:</label>
                        <input type="text" id="nova-tese-nome" placeholder="Digite o nome da nova tese">
                    </div>
                    <div class="form-group">
                        <label>Tipo de Tese:</label>
                        <select id="nova-tese-tipo">
                            <option value="inicial">Tese para Inicial</option>
                            <option value="impugnacao">Tese para Impugna√ß√£o</option>
                            <option value="recurso">Tese para Recurso</option>
                        </select>
                    </div>
                    <button class="btn btn-success" onclick="criarNovaTese()">‚ûï Criar Nova Tese</button>
                </div>
                
                <div class="teses-grid">
                    <div class="tese-card">
                        <h4>üìù Teses para Inicial</h4>
                        <div class="form-group">
                            <label>Selecione a Tese:</label>
                            <select id="tese-inicial" onchange="mostrarFormularioTese('inicial')">
                                <option value="">Selecione uma tese</option>
                            </select>
                        </div>
                        <div id="formulario-tese-inicial" class="tese-form" style="display: none;">
                            <div class="form-group">
                                <label>Conte√∫do da Tese:</label>
                                <textarea id="conteudo-tese-inicial" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                            </div>
                            <div class="btn-row">
                                <button class="btn btn-success btn-small" onclick="salvarTese('inicial')">üíæ Salvar Tese</button>
                                <button class="btn btn-info btn-small" onclick="editarTese('inicial')">‚úèÔ∏è Editar Tese</button>
                                <button class="btn btn-danger btn-small" onclick="excluirTese('inicial')">üóëÔ∏è Excluir Tese</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tese-card">
                        <h4>‚öñÔ∏è Teses para Impugna√ß√£o</h4>
                        <div class="form-group">
                            <label>Selecione a Tese:</label>
                            <select id="tese-impugnacao" onchange="mostrarFormularioTese('impugnacao')">
                                <option value="">Selecione uma tese</option>
                            </select>
                        </div>
                        <div id="formulario-tese-impugnacao" class="tese-form" style="display: none;">
                            <div class="form-group">
                                <label>Conte√∫do da Tese:</label>
                                <textarea id="conteudo-tese-impugnacao" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                            </div>
                            <div class="btn-row">
                                <button class="btn btn-success btn-small" onclick="salvarTese('impugnacao')">üíæ Salvar Tese</button>
                                <button class="btn btn-info btn-small" onclick="editarTese('impugnacao')">‚úèÔ∏è Editar Tese</button>
                                <button class="btn btn-danger btn-small" onclick="excluirTese('impugnacao')">üóëÔ∏è Excluir Tese</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tese-card">
                        <h4>üìÑ Teses para Recurso</h4>
                        <div class="form-group">
                            <label>Selecione a Tese:</label>
                            <select id="tese-recurso" onchange="mostrarFormularioTese('recurso')">
                                <option value="">Selecione uma tese</option>
                            </select>
                        </div>
                        <div id="formulario-tese-recurso" class="tese-form" style="display: none;">
                            <div class="form-group">
                                <label>Conte√∫do da Tese:</label>
                                <textarea id="conteudo-tese-recurso" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                            </div>
                            <div class="btn-row">
                                <button class="btn btn-success btn-small" onclick="salvarTese('recurso')">üíæ Salvar Tese</button>
                                <button class="btn btn-info btn-small" onclick="editarTese('recurso')">‚úèÔ∏è Editar Tese</button>
                                <button class="btn btn-danger btn-small" onclick="excluirTese('recurso')">üóëÔ∏è Excluir Tese</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao In√≠cio</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Consultar Teses Cadastradas -->
        <div id="consultar-teses" class="tab-content">
            <div class="card">
                <h3>üîç Consultar Teses Cadastradas</h3>
                
                <div class="tese-selecao">
                    <div class="form-group">
                        <label>Selecione o Tipo de Tese:</label>
                        <select id="tipo-tese-consulta" onchange="carregarTesesParaConsulta()">
                            <option value="">Selecione o tipo</option>
                            <option value="inicial">Tese para Inicial</option>
                            <option value="impugnacao">Tese para Impugna√ß√£o</option>
                            <option value="recurso">Tese para Recurso</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Selecione a Tese:</label>
                        <select id="tese-consulta" onchange="mostrarTeseSelecionada()">
                            <option value="">Selecione uma tese</option>
                        </select>
                    </div>
                </div>
                
                <div id="tese-exibicao" style="display: none;">
                    <div class="card">
                        <h4 id="titulo-tese"></h4>
                        <div class="data-item">
                            <pre id="conteudo-tese-consulta" style="white-space: pre-wrap; font-family: inherit;"></pre>
                        </div>
                        <button class="btn btn-success" onclick="copiarTeseConsulta()">üìã Copiar Tese</button>
                        <button class="print-btn" onclick="imprimirTese()">üñ®Ô∏è Imprimir Tese</button>
                    </div>
                </div>
                
                <div class="container-botoes">
                    <button class="btn" onclick="showTab('teses')">‚Ü©Ô∏è Voltar ao Cadastro de Teses</button>
                    <div class="botoes-direita">
                        <button class="btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- File Input para Importar Backup (hidden) -->
    <input type="file" id="backup-file" accept=".json" style="display: none;">

    <script>
        // ========== SISTEMA DE BANCO DE DADOS ==========
        const DB = {
            clientes: JSON.parse(localStorage.getItem('sistema_juridico_clientes')) || [],
            processos: JSON.parse(localStorage.getItem('sistema_juridico_processos')) || [],
            andamentos: JSON.parse(localStorage.getItem('sistema_juridico_andamentos')) || [],
            teses: JSON.parse(localStorage.getItem('sistema_juridico_teses')) || {
                inicial: {},
                impugnacao: {},
                recurso: {}
            },
            
            salvar: function() {
                localStorage.setItem('sistema_juridico_clientes', JSON.stringify(this.clientes));
                localStorage.setItem('sistema_juridico_processos', JSON.stringify(this.processos));
                localStorage.setItem('sistema_juridico_andamentos', JSON.stringify(this.andamentos));
                localStorage.setItem('sistema_juridico_teses', JSON.stringify(this.teses));
                atualizarEstatisticas();
                // ATUALIZAR LISTA EM TEMPO REAL
                if (document.getElementById('clientes').classList.contains('active')) {
                    atualizarListaClientesRealtime();
                }
            },
            
            gerarCodigoCliente: function() {
                const ultimoCodigo = this.clientes.reduce((max, cliente) => {
                    const num = parseInt(cliente.codigo) || 0;
                    return num > max ? num : max;
                }, 0);
                return String(ultimoCodigo + 1).padStart(3, '0');
            }
        };

        // ========== SISTEMA DE ATUALIZA√á√ÉO UNIVERSAL ==========
        function atualizarSistema() {
            console.log('üîÑ Iniciando atualiza√ß√£o do sistema...');
            
            // 1. Recarregar dados do localStorage
            try {
                DB.clientes = JSON.parse(localStorage.getItem('sistema_juridico_clientes')) || [];
                DB.processos = JSON.parse(localStorage.getItem('sistema_juridico_processos')) || [];
                DB.andamentos = JSON.parse(localStorage.getItem('sistema_juridico_andamentos')) || [];
                DB.teses = JSON.parse(localStorage.getItem('sistema_juridico_teses')) || {
                    inicial: {}, impugnacao: {}, recurso: {}
                };
            } catch (e) {
                console.error('Erro ao carregar dados:', e);
                // Recriar estruturas se corrompidas
                DB.clientes = [];
                DB.processos = [];
                DB.andamentos = [];
                DB.teses = { inicial: {}, impugnacao: {}, recurso: {} };
            }
            
            // 2. Identificar qual aba est√° ativa e atualizar conforme necess√°rio
            const abaAtivaElement = document.querySelector('.tab-content.active');
            if (!abaAtivaElement) {
                console.error('Nenhuma aba ativa encontrada');
                return;
            }
            
            const abaAtiva = abaAtivaElement.id;
            console.log('Aba ativa:', abaAtiva);
            
            switch(abaAtiva) {
                case 'clientes':
                    atualizarListaClientesRealtime();
                    document.getElementById('cliente-codigo').value = DB.gerarCodigoCliente();
                    break;
                    
                case 'editar-cliente':
                    document.getElementById('buscar-cliente-editar').value = '';
                    document.getElementById('form-editar-cliente').style.display = 'none';
                    break;
                    
                case 'processos':
                    document.getElementById('processo-numero').value = '';
                    document.getElementById('processo-tipo').value = '';
                    document.getElementById('processo-local').value = '';
                    document.getElementById('processo-data').valueAsDate = new Date();
                    document.getElementById('processo-cliente').value = '';
                    document.getElementById('processo-resumo').value = '';
                    break;
                    
                case 'andamento':
                    document.getElementById('buscar-cliente-andamento').value = '';
                    document.getElementById('info-cliente-andamento').style.display = 'none';
                    document.getElementById('novo-andamento').value = '';
                    break;
                    
                case 'consultas':
                    document.getElementById('resultados-consulta').innerHTML = '';
                    document.getElementById('consulta-cliente').value = '';
                    document.getElementById('consulta-processo').value = '';
                    break;
                    
                case 'relatorios':
                    document.getElementById('relatorio-conteudo').innerHTML = '';
                    document.getElementById('relatorio-cliente-especifico').value = '';
                    break;
                    
                case 'teses':
                    carregarTeses();
                    break;
                    
                case 'consultar-teses':
                    carregarTesesParaConsulta();
                    document.getElementById('tese-exibicao').style.display = 'none';
                    break;
            }
            
            // 3. Atualizar estat√≠sticas globais
            atualizarEstatisticas();
            
            // 4. Feedback visual
            mostrarFeedbackAtualizacao();
        }

        function mostrarFeedbackAtualizacao() {
            // Criar feedback visual tempor√°rio
            const feedback = document.createElement('div');
            feedback.style.position = 'fixed';
            feedback.style.top = '20px';
            feedback.style.right = '20px';
            feedback.style.background = '#28a745';
            feedback.style.color = 'white';
            feedback.style.padding = '15px 20px';
            feedback.style.borderRadius = '8px';
            feedback.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
            feedback.style.zIndex = '10000';
            feedback.style.fontWeight = '600';
            feedback.style.display = 'flex';
            feedback.style.alignItems = 'center';
            feedback.style.gap = '10px';
            
            feedback.innerHTML = '‚úÖ Sistema atualizado com sucesso!';
            
            document.body.appendChild(feedback);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                feedback.style.opacity = '0';
                feedback.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    if (feedback.parentNode) {
                        feedback.parentNode.removeChild(feedback);
                    }
                }, 500);
            }, 3000);
        }

        // ========== FUN√á√ÉO PARA ATUALIZAR LISTA EM TEMPO REAL ==========
        function atualizarListaClientesRealtime() {
            const listaContainer = document.getElementById('lista-clientes-realtime');
            const contador = document.getElementById('contador-clientes');
            
            if (!listaContainer) return;
            
            contador.textContent = DB.clientes.length;
            
            if (DB.clientes.length === 0) {
                listaContainer.innerHTML = '<div class="cliente-item">Nenhum cliente cadastrado ainda.</div>';
                return;
            }
            
            // Ordenar clientes por c√≥digo (mais recentes primeiro)
            const clientesOrdenados = [...DB.clientes].sort((a, b) => b.codigo.localeCompare(a.codigo));
            
            let html = '';
            clientesOrdenados.forEach(cliente => {
                html += `
                    <div class="cliente-item">
                        <div class="cliente-header">
                            <strong>${cliente.nome}</strong>
                            <span class="cliente-codigo">${cliente.codigo}</span>
                        </div>
                        <div class="detalhes">
                            ${cliente.cpf ? 'CPF: ' + cliente.cpf + '<br>' : ''}
                            ${cliente.telefone ? 'Tel: ' + cliente.telefone + '<br>' : ''}
                            ${cliente.email ? 'Email: ' + cliente.email : ''}
                            ${!cliente.cpf && !cliente.telefone && !cliente.email ? 'Sem informa√ß√µes adicionais' : ''}
                        </div>
                    </div>
                `;
            });
            
            listaContainer.innerHTML = html;
        }

        // ========== SISTEMA DE AUTO-REPARO ==========
        function executarAutoReparo() {
            console.log('üõ†Ô∏è Iniciando sistema de auto-reparo...');
            const problemasEncontrados = [];
            const problemasCorrigidos = [];

            // 1. Verificar e corrigir estrutura do banco de dados
            if (!localStorage.getItem('sistema_juridico_clientes')) {
                localStorage.setItem('sistema_juridico_clientes', '[]');
                problemasCorrigidos.push('Estrutura de clientes criada');
            }
            
            if (!localStorage.getItem('sistema_juridico_processos')) {
                localStorage.setItem('sistema_juridico_processos', '[]');
                problemasCorrigidos.push('Estrutura de processos criada');
            }
            
            if (!localStorage.getItem('sistema_juridico_andamentos')) {
                localStorage.setItem('sistema_juridico_andamentos', '[]');
                problemasCorrigidos.push('Estrutura de andamentos criada');
            }
            
            if (!localStorage.getItem('sistema_juridico_teses')) {
                localStorage.setItem('sistema_juridico_teses', JSON.stringify({
                    inicial: {},
                    impugnacao: {},
                    recurso: {}
                }));
                problemasCorrigidos.push('Estrutura de teses criada');
            }

            // 2. Verificar dados corrompidos
            try {
                JSON.parse(localStorage.getItem('sistema_juridico_clientes'));
            } catch (e) {
                localStorage.setItem('sistema_juridico_clientes', '[]');
                problemasCorrigidos.push('Dados de clientes corrompidos - resetados');
            }

            try {
                JSON.parse(localStorage.getItem('sistema_juridico_processos'));
            } catch (e) {
                localStorage.setItem('sistema_juridico_processos', '[]');
                problemasCorrigidos.push('Dados de processos corrompidos - resetados');
            }

            try {
                JSON.parse(localStorage.getItem('sistema_juridico_teses'));
            } catch (e) {
                localStorage.setItem('sistema_juridico_teses', JSON.stringify({
                    inicial: {},
                    impugnacao: {},
                    recurso: {}
                }));
                problemasCorrigidos.push('Dados de teses corrompidos - resetados');
            }

            // 3. Recarregar dados
            DB.clientes = JSON.parse(localStorage.getItem('sistema_juridico_clientes')) || [];
            DB.processos = JSON.parse(localStorage.getItem('sistema_juridico_processos')) || [];
            DB.andamentos = JSON.parse(localStorage.getItem('sistema_juridico_andamentos')) || [];
            DB.teses = JSON.parse(localStorage.getItem('sistema_juridico_teses')) || {
                inicial: {}, impugnacao: {}, recurso: {}
            };

            // 4. Atualizar interface
            atualizarEstatisticas();
            if (document.getElementById('clientes').classList.contains('active')) {
                atualizarListaClientesRealtime();
            }

            // 5. Exibir resultado
            let mensagem = '‚úÖ Sistema verificado com sucesso!\n\n';
            
            if (problemasCorrigidos.length > 0) {
                mensagem += 'üîß Problemas corrigidos:\n';
                problemasCorrigidos.forEach(problema => {
                    mensagem += '‚Ä¢ ' + problema + '\n';
                });
            }
            
            if (problemasEncontrados.length > 0) {
                mensagem += '\n‚ö†Ô∏è Problemas encontrados (necess√°ria aten√ß√£o):\n';
                problemasEncontrados.forEach(problema => {
                    mensagem += '‚Ä¢ ' + problema + '\n';
                });
            }
            
            if (problemasCorrigidos.length === 0 && problemasEncontrados.length === 0) {
                mensagem += 'üéâ Nenhum problema encontrado! O sistema est√° funcionando perfeitamente.';
            }

            alert(mensagem);
            console.log('üõ†Ô∏è Auto-reparo conclu√≠do:', { problemasEncontrados, problemasCorrigidos });
        }

        // ========== FUN√á√ïES DE FORMATA√á√ÉO ==========
        function formatarCPF(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 11) value = value.substring(0, 11);
            
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            
            input.value = value;
        }

        function formatarRG(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 9) value = value.substring(0, 9);
            
            if (value.length <= 9) {
                value = value.replace(/(\d{2})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            
            input.value = value;
        }

        // ========== FUN√á√ïES PRINCIPAIS ==========
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'clientes') {
                // Limpar formul√°rio e gerar novo c√≥digo
                limparFormularioCliente();
                document.getElementById('cliente-codigo').value = DB.gerarCodigoCliente();
                document.getElementById('btn-salvar-cliente').disabled = false;
                document.getElementById('mensagem-cliente').innerHTML = '';
                // ATUALIZAR LISTA EM TEMPO REAL
                atualizarListaClientesRealtime();
            }
            
            if (tabName === 'teses') {
                carregarTeses();
            }
            
            if (tabName === 'consultar-teses') {
                document.getElementById('tese-exibicao').style.display = 'none';
            }
            
            atualizarEstatisticas();
        }

        function limparFormularioCliente() {
            document.getElementById('cliente-nome').value = '';
            document.getElementById('cliente-sexo').value = '';
            document.getElementById('cliente-cpf').value = '';
            document.getElementById('cliente-rg').value = '';
            document.getElementById('cliente-endereco').value = '';
            document.getElementById('cliente-telefone').value = '';
            document.getElementById('cliente-email').value = '';
            document.getElementById('cliente-observacoes').value = '';
        }

        function salvarCliente() {
            const btnSalvar = document.getElementById('btn-salvar-cliente');
            const mensagemDiv = document.getElementById('mensagem-cliente');
            
            // Limpar mensagens anteriores
            mensagemDiv.innerHTML = '';
            
            const cliente = {
                codigo: document.getElementById('cliente-codigo').value,
                nome: document.getElementById('cliente-nome').value.trim(),
                sexo: document.getElementById('cliente-sexo').value,
                cpf: document.getElementById('cliente-cpf').value.trim(),
                rg: document.getElementById('cliente-rg').value.trim(),
                endereco: document.getElementById('cliente-endereco').value.trim(),
                telefone: document.getElementById('cliente-telefone').value.trim(),
                email: document.getElementById('cliente-email').value.trim(),
                observacoes: document.getElementById('cliente-observacoes').value.trim(),
                dataCadastro: new Date().toLocaleDateString('pt-BR')
            };

            // Valida√ß√µes
            if (!cliente.nome) {
                mensagemDiv.innerHTML = '<div class="alert alert-danger">‚ùå Nome √© obrigat√≥rio!</div>';
                return;
            }

            // Verificar se j√° existe cliente com mesmo CPF
            if (cliente.cpf) {
                const clienteExistente = DB.clientes.find(c => c.cpf === cliente.cpf);
                if (clienteExistente) {
                    mensagemDiv.innerHTML = '<div class="alert alert-danger">‚ùå J√° existe um cliente cadastrado com este CPF!</div>';
                    return;
                }
            }

            // Desabilitar o bot√£o para evitar m√∫ltiplos salvamentos
            btnSalvar.disabled = true;

            DB.clientes.push(cliente);
            DB.salvar();
            
            // Exibir mensagem de confirma√ß√£o
            mensagemDiv.innerHTML = '<div class="alert alert-success">‚úÖ Cliente <strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong> salvo com sucesso!</div>';
            
            // Limpar formul√°rio e gerar novo c√≥digo
            limparFormularioCliente();
            document.getElementById('cliente-codigo').value = DB.gerarCodigoCliente();
            
            // Reabilitar o bot√£o ap√≥s 2 segundos
            setTimeout(() => {
                btnSalvar.disabled = false;
            }, 2000);
        }

        function buscarClienteEditar() {
            const termo = document.getElementById('buscar-cliente-editar').value.trim();
            if (!termo) {
                alert('‚ùå Digite um c√≥digo ou CPF para buscar!');
                return;
            }

            const cliente = DB.clientes.find(c => 
                c.codigo === termo || c.cpf === termo
            );

            if (cliente) {
                document.getElementById('editar-codigo').value = cliente.codigo;
                document.getElementById('editar-nome').value = cliente.nome;
                document.getElementById('editar-sexo').value = cliente.sexo;
                document.getElementById('editar-cpf').value = cliente.cpf;
                document.getElementById('editar-rg').value = cliente.rg;
                document.getElementById('editar-endereco').value = cliente.endereco;
                document.getElementById('editar-telefone').value = cliente.telefone;
                document.getElementById('editar-email').value = cliente.email;
                document.getElementById('editar-observacoes').value = cliente.observacoes;
                
                document.getElementById('form-editar-cliente').style.display = 'block';
            } else {
                alert('‚ùå Cliente n√£o encontrado!');
            }
        }

        function atualizarCliente() {
            const codigo = document.getElementById('editar-codigo').value;
            const clienteIndex = DB.clientes.findIndex(c => c.codigo === codigo);
            
            if (clienteIndex === -1) {
                alert('‚ùå Cliente n√£o encontrado!');
                return;
            }

            DB.clientes[clienteIndex] = {
                ...DB.clientes[clienteIndex],
                nome: document.getElementById('editar-nome').value.trim(),
                sexo: document.getElementById('editar-sexo').value,
                cpf: document.getElementById('editar-cpf').value.trim(),
                rg: document.getElementById('editar-rg').value.trim(),
                endereco: document.getElementById('editar-endereco').value.trim(),
                telefone: document.getElementById('editar-telefone').value.trim(),
                email: document.getElementById('editar-email').value.trim(),
                observacoes: document.getElementById('editar-observacoes').value.trim()
            };

            DB.salvar();
            
            // Exibir mensagem de confirma√ß√£o
            const resultados = document.getElementById('resultados-consulta');
            resultados.innerHTML = '<div class="alert alert-success">‚úÖ Cliente ' + codigo + ' - ' + DB.clientes[clienteIndex].nome + ' atualizado com sucesso!</div>';
            
            // Limpar formul√°rio
            document.getElementById('buscar-cliente-editar').value = '';
            document.getElementById('form-editar-cliente').style.display = 'none';
            
            // Mostrar a aba de consultas para exibir a mensagem
            showTab('consultas');
        }

        function salvarProcesso() {
            const processo = {
                numero: document.getElementById('processo-numero').value.trim(),
                tipo: document.getElementById('processo-tipo').value,
                local: document.getElementById('processo-local').value.trim(),
                data: document.getElementById('processo-data').value ? 
                      new Date(document.getElementById('processo-data').value).toLocaleDateString('pt-BR') : 
                      new Date().toLocaleDateString('pt-BR'),
                cliente: document.getElementById('processo-cliente').value.trim(),
                resumo: document.getElementById('processo-resumo').value.trim(),
                dataCadastro: new Date().toLocaleDateString('pt-BR')
            };

            if (!processo.numero || !processo.tipo || !processo.cliente || !processo.resumo) {
                alert('‚ùå Campos obrigat√≥rios: N√∫mero, Tipo, Cliente e Resumo!');
                return;
            }

            // Verificar se cliente existe
            const clienteExiste = DB.clientes.find(c => c.codigo === processo.cliente);
            if (!clienteExiste) {
                if (!confirm('‚ö†Ô∏è Cliente n√£o encontrado. Deseja cadastrar mesmo assim?')) {
                    return;
                }
            }

            DB.processos.push(processo);
            DB.salvar();
            
            // Limpar formul√°rio
            document.getElementById('processo-numero').value = '';
            document.getElementById('processo-tipo').value = '';
            document.getElementById('processo-local').value = '';
            document.getElementById('processo-data').value = '';
            document.getElementById('processo-cliente').value = '';
            document.getElementById('processo-resumo').value = '';
            
            alert('‚úÖ Processo salvo com sucesso!');
            showTab('dashboard');
        }

        function buscarClienteAndamento() {
            const termo = document.getElementById('buscar-cliente-andamento').value.trim();
            if (!termo) {
                alert('‚ùå Digite um c√≥digo ou CPF para buscar!');
                return;
            }

            const cliente = DB.clientes.find(c => 
                c.codigo === termo || c.cpf === termo
            );

            if (cliente) {
                document.getElementById('cliente-info').innerHTML = '<strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>CPF: ' + cliente.cpf + ' | Tel: ' + cliente.telefone;
                document.getElementById('info-cliente-andamento').style.display = 'block';
                document.getElementById('novo-andamento').value = '';
            } else {
                alert('‚ùå Cliente n√£o encontrado!');
            }
        }

        function adicionarAndamento() {
            const clienteCodigo = document.getElementById('buscar-cliente-andamento').value.trim();
            const andamentoTexto = document.getElementById('novo-andamento').value.trim();

            if (!andamentoTexto) {
                alert('‚ùå Digite o andamento processual!');
                return;
            }

            const andamento = {
                cliente: clienteCodigo,
                texto: andamentoTexto,
                data: new Date().toLocaleString('pt-BR'),
                tipo: 'Andamento Processual'
            };

            DB.andamentos.push(andamento);
            DB.salvar();

            alert('‚úÖ Andamento adicionado com sucesso!');
            document.getElementById('novo-andamento').value = '';
        }

        // ========== FUN√á√ïES DE CONSULTA ==========
        function consultarClientes() {
            const termo = document.getElementById('consulta-cliente').value.toLowerCase().trim();
            const resultados = document.getElementById('resultados-consulta');
            
            resultados.innerHTML = '';
            
            let clientesFiltrados = DB.clientes;
            
            if (termo) {
                clientesFiltrados = DB.clientes.filter(cliente => 
                    cliente.codigo.toLowerCase().includes(termo) ||
                    cliente.nome.toLowerCase().includes(termo) ||
                    (cliente.cpf && cliente.cpf.includes(termo)) ||
                    (cliente.telefone && cliente.telefone.includes(termo))
                );
            }
            
            exibirResultadosClientes(clientesFiltrados);
        }

        function listarTodosClientes() {
            exibirResultadosClientes(DB.clientes);
        }

        function exibirResultadosClientes(clientes) {
            const resultados = document.getElementById('resultados-consulta');
            resultados.innerHTML = '';
            
            if (clientes.length === 0) {
                resultados.innerHTML = '<div class="data-item">Nenhum cliente encontrado.</div>';
                return;
            }

            clientes.forEach(cliente => {
                const item = document.createElement('div');
                item.className = 'data-item';
                item.innerHTML = '<strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>üìû ' + cliente.telefone + ' | üìß ' + cliente.email + '<br>üÜî CPF: ' + cliente.cpf + ' | RG: ' + cliente.rg + '<br>üìç ' + cliente.endereco + '<br><small>üìÖ Cadastrado em: ' + cliente.dataCadastro + '</small><button class="btn btn-danger btn-small" onclick="excluirCliente(\'' + cliente.codigo + '\')" style="margin-top: 10px;">üóëÔ∏è Excluir</button>';
                resultados.appendChild(item);
            });
            
            showTab('consultas');
        }

        function consultarProcessos() {
            const termo = document.getElementById('consulta-processo').value.toLowerCase().trim();
            const resultados = document.getElementById('resultados-consulta');
            
            resultados.innerHTML = '';
            
            let processosFiltrados = DB.processos;
            
            if (termo) {
                processosFiltrados = DB.processos.filter(processo => 
                    processo.numero.toLowerCase().includes(termo) ||
                    processo.tipo.toLowerCase().includes(termo) ||
                    processo.cliente.toLowerCase().includes(termo) ||
                    processo.resumo.toLowerCase().includes(termo)
                );
            }
            
            exibirResultadosProcessos(processosFiltrados);
        }

        function listarTodosProcessos() {
            exibirResultadosProcessos(DB.processos);
        }

        function exibirResultadosProcessos(processos) {
            const resultados = document.getElementById('resultados-consulta');
            resultados.innerHTML = '';
            
            if (processos.length === 0) {
                resultados.innerHTML = '<div class="data-item">Nenhum processo encontrado.</div>';
                return;
            }

            processos.forEach(processo => {
                const cliente = DB.clientes.find(c => c.codigo === processo.cliente);
                const nomeCliente = cliente ? cliente.nome : 'Cliente n√£o encontrado';
                
                const item = document.createElement('div');
                item.className = 'data-item';
                item.innerHTML = '<strong>' + processo.numero + ' - ' + processo.tipo + '</strong><br>üë§ Cliente: ' + processo.cliente + ' - ' + nomeCliente + '<br>üìç Local: ' + (processo.local || 'N√£o informado') + '<br>üìÖ Data: ' + processo.data + '<br>üìù Resumo: ' + processo.resumo + '<br><small>üìÖ Cadastrado em: ' + processo.dataCadastro + '</small><button class="btn btn-danger btn-small" onclick="excluirProcesso(\'' + processo.numero + '\')" style="margin-top: 10px;">üóëÔ∏è Excluir</button>';
                resultados.appendChild(item);
            });
            
            showTab('consultas');
        }

        function consultarAndamentoProcessual() {
            const resultados = document.getElementById('resultados-consulta');
            resultados.innerHTML = '<h4>üìà Andamento Processual - Todos os Clientes</h4>';
            
            DB.clientes.forEach(cliente => {
                const processosCliente = DB.processos.filter(p => p.cliente === cliente.codigo);
                const andamentosCliente = DB.andamentos.filter(a => a.cliente === cliente.codigo);
                
                const item = document.createElement('div');
                item.className = 'data-item';
                
                let conteudo = '<strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>';
                
                if (processosCliente.length > 0) {
                    conteudo += '<br><strong>Processos:</strong><br>';
                    processosCliente.forEach(processo => {
                        conteudo += '‚Ä¢ ' + processo.numero + ' - ' + processo.tipo + '<br>';
                    });
                }
                
                if (andamentosCliente.length > 0) {
                    conteudo += '<br><strong>√öltimos Andamentos:</strong><br>';
                    andamentosCliente.slice(-3).forEach(andamento => {
                        conteudo += '‚Ä¢ ' + andamento.data + ': ' + andamento.texto + '<br>';
                    });
                }
                
                if (processosCliente.length === 0 && andamentosCliente.length === 0) {
                    conteudo += '<br>üì≠ Nenhum processo ou andamento registrado.';
                }
                
                item.innerHTML = conteudo;
                resultados.appendChild(item);
            });
            
            showTab('consultas');
        }

        // ========== FUN√á√ïES DE EXCLUS√ÉO ==========
        function excluirCliente(codigo) {
            if (confirm('‚ö†Ô∏è Tem certeza que deseja excluir o cliente ' + codigo + '?')) {
                DB.clientes = DB.clientes.filter(c => c.codigo !== codigo);
                DB.processos = DB.processos.filter(p => p.cliente !== codigo);
                DB.andamentos = DB.andamentos.filter(a => a.cliente !== codigo);
                DB.salvar();
                
                // ATUALIZA√á√ÉO IMEDIATA
                const abaAtivaElement = document.querySelector('.tab-content.active');
                if (abaAtivaElement) {
                    const abaAtiva = abaAtivaElement.id;
                    if (abaAtiva === 'consultas') {
                        consultarClientes();
                    } else if (abaAtiva === 'clientes') {
                        atualizarListaClientesRealtime();
                    }
                }
                
                mostrarFeedbackExclusao('Cliente exclu√≠do com sucesso!');
            }
        }

        function excluirProcesso(numero) {
            if (confirm('‚ö†Ô∏è Tem certeza que deseja excluir o processo ' + numero + '?')) {
                DB.processos = DB.processos.filter(p => p.numero !== numero);
                DB.salvar();
                
                // ATUALIZA√á√ÉO IMEDIATA
                const abaAtivaElement = document.querySelector('.tab-content.active');
                if (abaAtivaElement && abaAtivaElement.id === 'consultas') {
                    consultarProcessos();
                }
                
                mostrarFeedbackExclusao('Processo exclu√≠do com sucesso!');
            }
        }

        function mostrarFeedbackExclusao(mensagem) {
            const feedback = document.createElement('div');
            feedback.style.position = 'fixed';
            feedback.style.top = '20px';
            feedback.style.right = '20px';
            feedback.style.background = '#dc3545';
            feedback.style.color = 'white';
            feedback.style.padding = '15px 20px';
            feedback.style.borderRadius = '8px';
            feedback.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
            feedback.style.zIndex = '10000';
            feedback.style.fontWeight = '600';
            feedback.style.display = 'flex';
            feedback.style.alignItems = 'center';
            feedback.style.gap = '10px';
            
            feedback.innerHTML = '‚úÖ ' + mensagem;
            
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.opacity = '0';
                feedback.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    if (feedback.parentNode) {
                        feedback.parentNode.removeChild(feedback);
                    }
                }, 500);
            }, 3000);
        }

        // ========== FUN√á√ïES DE RELAT√ìRIOS ==========
        function gerarRelatorioClientesAlfabetico() {
            const conteudo = document.getElementById('relatorio-conteudo');
            const clientesOrdenados = [...DB.clientes].sort((a, b) => a.nome.localeCompare(b.nome));
            
            let html = '<div class="no-print"><button class="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button></div><h3>üë§ Relat√≥rio de Clientes (Ordem Alfab√©tica)</h3>';
            
            if (clientesOrdenados.length === 0) {
                html += '<div class="data-item">Nenhum cliente cadastrado.</div>';
            } else {
                html += '<p><strong>Total de clientes:</strong> ' + clientesOrdenados.length + '</p>';
                
                clientesOrdenados.forEach(cliente => {
                    html += '<div class="data-item"><strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>Sexo: ' + (cliente.sexo || 'N√£o informado') + ' | CPF: ' + (cliente.cpf || 'N√£o informado') + '<br>RG: ' + (cliente.rg || 'N√£o informado') + ' | Tel: ' + (cliente.telefone || 'N√£o informado') + '<br>Email: ' + (cliente.email || 'N√£o informado') + '<br>Endere√ßo: ' + (cliente.endereco || 'N√£o informado') + '<br>Observa√ß√µes: ' + (cliente.observacoes || 'Nenhuma') + '<br><small>üìÖ Cadastrado em: ' + cliente.dataCadastro + '</small></div>';
                });
            }
            
            conteudo.innerHTML = html;
            showTab('relatorios');
        }

        function gerarRelatorioClientesProcesso() {
            const conteudo = document.getElementById('relatorio-conteudo');
            
            let html = '<div class="no-print"><button class="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button></div><h3>‚öñÔ∏è Relat√≥rio - Clientes por Processo</h3>';
            
            if (DB.clientes.length === 0) {
                html += '<div class="data-item">Nenhum cliente cadastrado.</div>';
            } else {
                DB.clientes.forEach(cliente => {
                    const processosCliente = DB.processos.filter(p => p.cliente === cliente.codigo);
                    
                    html += '<div class="data-item"><strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>üìû ' + cliente.telefone + '<br>Processos: ' + processosCliente.length + '<br>';
                    
                    if (processosCliente.length > 0) {
                        processosCliente.forEach(processo => {
                            html += '‚Ä¢ ' + processo.numero + ' - ' + processo.tipo + '<br>';
                        });
                    } else {
                        html += 'üì≠ Nenhum processo cadastrado<br>';
                    }
                    
                    html += '</div>';
                });
            }
            
            conteudo.innerHTML = html;
            showTab('relatorios');
        }

        function gerarRelatorioClienteEspecifico() {
            const termo = document.getElementById('relatorio-cliente-especifico').value.trim();
            const conteudo = document.getElementById('relatorio-conteudo');
            
            if (!termo) {
                alert('‚ùå Digite um c√≥digo ou CPF do cliente!');
                return;
            }

            const cliente = DB.clientes.find(c => 
                c.codigo === termo || c.cpf === termo
            );

            if (!cliente) {
                conteudo.innerHTML = '<div class="data-item">Cliente n√£o encontrado.</div>';
                return;
            }

            const processosCliente = DB.processos.filter(p => p.cliente === cliente.codigo);
            const andamentosCliente = DB.andamentos.filter(a => a.cliente === cliente.codigo);

            let html = '<div class="no-print"><button class="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button></div><h3>üìã Relat√≥rio - Cliente Espec√≠fico</h3><div class="data-item"><h4>Dados Pessoais</h4><strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>Sexo: ' + (cliente.sexo || 'N√£o informado') + '<br>CPF: ' + cliente.cpf + ' | RG: ' + cliente.rg + '<br>Telefone: ' + cliente.telefone + '<br>Email: ' + cliente.email + '<br>Endere√ßo: ' + cliente.endereco + '<br>Observa√ß√µes: ' + (cliente.observacoes || 'Nenhuma') + '<br><small>üìÖ Cadastrado em: ' + cliente.dataCadastro + '</small></div>';

            if (processosCliente.length > 0) {
                html += '<div class="data-item"><h4>üìÅ Processos do Cliente</h4>';
                processosCliente.forEach(processo => {
                    html += '<div style="margin: 10px 0; padding: 10px; background: #e3f2fd; border-radius: 5px;"><strong>' + processo.numero + ' - ' + processo.tipo + '</strong><br>Local: ' + (processo.local || 'N√£o informado') + '<br>Data In√≠cio: ' + processo.data + '<br><strong>Resumo:</strong> ' + processo.resumo + '</div>';
                });
                html += '</div>';
            }

            if (andamentosCliente.length > 0) {
                html += '<div class="data-item"><h4>üìà Hist√≥rico de Andamentos</h4>';
                andamentosCliente.forEach(andamento => {
                    html += '<div style="margin: 8px 0; padding: 8px; background: #fff3cd; border-radius: 5px;"><strong>' + andamento.data + '</strong><br>' + andamento.texto + '</div>';
                });
                html += '</div>';
            }

            if (processosCliente.length === 0) {
                html += '<div class="data-item">üì≠ Nenhum processo cadastrado para este cliente.</div>';
            }

            conteudo.innerHTML = html;
            showTab('relatorios');
        }

        function gerarRelatorioProcessosDetalhado() {
            const conteudo = document.getElementById('relatorio-conteudo');
            
            let html = '<div class="no-print"><button class="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button></div><h3>üìÅ Relat√≥rio - Processos Detalhados</h3>';
            
            if (DB.processos.length === 0) {
                html += '<div class="data-item">Nenhum processo cadastrado.</div>';
            } else {
                // Estat√≠sticas por tipo
                const processosPorTipo = {};
                DB.processos.forEach(processo => {
                    processosPorTipo[processo.tipo] = (processosPorTipo[processo.tipo] || 0) + 1;
                });
                
                html += '<p><strong>Total de processos:</strong> ' + DB.processos.length + '</p>';
                html += '<div style="margin: 15px 0;"><strong>Distribui√ß√£o por tipo:</strong></div>';
                
                for (const [tipo, quantidade] of Object.entries(processosPorTipo)) {
                    html += '<div style="margin: 5px 0;">‚Ä¢ ' + tipo + ': ' + quantidade + ' processo(s)</div>';
                }
                
                html += '<div style="margin-top: 20px;"><strong>Detalhes dos processos:</strong></div>';
                
                DB.processos.forEach(processo => {
                    const cliente = DB.clientes.find(c => c.codigo === processo.cliente);
                    const nomeCliente = cliente ? cliente.nome : 'Cliente n√£o encontrado';
                    
                    html += '<div class="data-item"><strong>' + processo.numero + '</strong> - ' + processo.tipo + '<br>Cliente: ' + nomeCliente + ' (' + processo.cliente + ')<br>Local: ' + (processo.local || 'N√£o informado') + '<br>Data: ' + processo.data + '<br>Resumo: ' + processo.resumo + '</div>';
                });
            }
            
            conteudo.innerHTML = html;
            showTab('relatorios');
        }

        function gerarRelatorioAndamentoGeral() {
            const conteudo = document.getElementById('relatorio-conteudo');
            
            let html = '<div class="no-print"><button class="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Relat√≥rio</button></div><h3>üìà Relat√≥rio - Andamento Processual Geral</h3>';
            
            if (DB.clientes.length === 0) {
                html += '<div class="data-item">Nenhum cliente cadastrado.</div>';
            } else {
                DB.clientes.forEach(cliente => {
                    const processosCliente = DB.processos.filter(p => p.cliente === cliente.codigo);
                    const andamentosCliente = DB.andamentos.filter(a => a.cliente === cliente.codigo);
                    
                    html += '<div class="data-item"><strong>' + cliente.codigo + ' - ' + cliente.nome + '</strong><br>Processos: ' + processosCliente.length + ' | Andamentos: ' + andamentosCliente.length + '<br>';
                    
                    if (andamentosCliente.length > 0) {
                        html += '<br><strong>√öltimos andamentos:</strong><br>';
                        andamentosCliente.slice(-2).forEach(andamento => {
                            html += '‚Ä¢ ' + andamento.data + ': ' + andamento.texto + '<br>';
                        });
                    } else {
                        html += '<br>üì≠ Nenhum andamento registrado.';
                    }
                    
                    html += '</div>';
                });
            }
            
            conteudo.innerHTML = html;
            showTab('relatorios');
        }

        // ========== FUN√á√ïES DE TESES JUR√çDICAS ==========
        function carregarTeses() {
            console.log('üìö Carregando teses...');
            
            // Carregar teses para Inicial
            const selectInicial = document.getElementById('tese-inicial');
            if (selectInicial) {
                selectInicial.innerHTML = '<option value="">Selecione uma tese</option>';
                for (const nome in DB.teses.inicial) {
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = nome;
                    selectInicial.appendChild(option);
                }
            }
            
            // Carregar teses para Impugna√ß√£o
            const selectImpugnacao = document.getElementById('tese-impugnacao');
            if (selectImpugnacao) {
                selectImpugnacao.innerHTML = '<option value="">Selecione uma tese</option>';
                for (const nome in DB.teses.impugnacao) {
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = nome;
                    selectImpugnacao.appendChild(option);
                }
            }
            
            // Carregar teses para Recurso
            const selectRecurso = document.getElementById('tese-recurso');
            if (selectRecurso) {
                selectRecurso.innerHTML = '<option value="">Selecione uma tese</option>';
                for (const nome in DB.teses.recurso) {
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = nome;
                    selectRecurso.appendChild(option);
                }
            }
        }

        function carregarTesesParaConsulta() {
            const tipo = document.getElementById('tipo-tese-consulta').value;
            const select = document.getElementById('tese-consulta');
            
            select.innerHTML = '<option value="">Selecione uma tese</option>';
            
            if (tipo && DB.teses[tipo]) {
                for (const nome in DB.teses[tipo]) {
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = nome;
                    select.appendChild(option);
                }
            }
            
            document.getElementById('tese-exibicao').style.display = 'none';
        }

        function mostrarTeseSelecionada() {
            const tipo = document.getElementById('tipo-tese-consulta').value;
            const nome = document.getElementById('tese-consulta').value;
            
            if (tipo && nome && DB.teses[tipo][nome]) {
                document.getElementById('titulo-tese').textContent = nome;
                document.getElementById('conteudo-tese-consulta').textContent = DB.teses[tipo][nome];
                document.getElementById('tese-exibicao').style.display = 'block';
            } else {
                document.getElementById('tese-exibicao').style.display = 'none';
            }
        }

        function criarNovaTese() {
            const nome = document.getElementById('nova-tese-nome').value.trim();
            const tipo = document.getElementById('nova-tese-tipo').value;
            
            if (!nome) {
                alert('‚ùå Digite um nome para a tese!');
                return;
            }
            
            // Verificar se j√° existe tese com esse nome no tipo selecionado
            if (DB.teses[tipo][nome]) {
                alert('‚ùå J√° existe uma tese com este nome neste tipo!');
                return;
            }
            
            // Criar a tese vazia
            DB.teses[tipo][nome] = '';
            DB.salvar();
            
            alert('‚úÖ Tese criada com sucesso! Agora voc√™ pode selecion√°-la e adicionar o conte√∫do.');
            
            // Limpar campo e recarregar as teses
            document.getElementById('nova-tese-nome').value = '';
            carregarTeses();
        }

        function mostrarFormularioTese(tipo) {
            const select = document.getElementById('tese-' + tipo);
            const formulario = document.getElementById('formulario-tese-' + tipo);
            const textarea = document.getElementById('conteudo-tese-' + tipo);
            
            if (select.value) {
                // Se j√° existe uma tese com esse nome, carregar o conte√∫do
                if (DB.teses[tipo][select.value]) {
                    textarea.value = DB.teses[tipo][select.value];
                } else {
                    textarea.value = '';
                }
                formulario.style.display = 'block';
            } else {
                formulario.style.display = 'none';
            }
        }

        function salvarTese(tipo) {
            const select = document.getElementById('tese-' + tipo);
            const textarea = document.getElementById('conteudo-tese-' + tipo);
            
            if (!select.value) {
                alert('‚ùå Selecione uma tese!');
                return;
            }
            
            if (!textarea.value.trim()) {
                alert('‚ùå Digite o conte√∫do da tese!');
                return;
            }
            
            DB.teses[tipo][select.value] = textarea.value.trim();
            DB.salvar();
            
            alert('‚úÖ Tese salva com sucesso!');
        }

        function editarTese(tipo) {
            const select = document.getElementById('tese-' + tipo);
            const textarea = document.getElementById('conteudo-tese-' + tipo);
            
            if (!select.value) {
                alert('‚ùå Selecione uma tese para editar!');
                return;
            }
            
            // Apenas focar no textarea para permitir edi√ß√£o
            textarea.focus();
            alert('‚úèÔ∏è Voc√™ pode editar o conte√∫do da tese diretamente no campo de texto. Clique em "Salvar Tese" quando terminar.');
        }

        function excluirTese(tipo) {
            const select = document.getElementById('tese-' + tipo);
            
            if (!select.value) {
                alert('‚ùå Selecione uma tese para excluir!');
                return;
            }
            
            if (confirm('‚ö†Ô∏è Tem certeza que deseja excluir a tese "' + select.value + '"?')) {
                delete DB.teses[tipo][select.value];
                DB.salvar();
                
                alert('‚úÖ Tese exclu√≠da com sucesso!');
                carregarTeses();
                
                // Limpar formul√°rio
                document.getElementById('formulario-tese-' + tipo).style.display = 'none';
                select.value = '';
            }
        }

        function copiarTeseConsulta() {
            const conteudo = document.getElementById('conteudo-tese-consulta').textContent;
            
            // Criar um elemento textarea tempor√°rio para copiar o texto
            const textarea = document.createElement('textarea');
            textarea.value = conteudo;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            alert('‚úÖ Tese copiada para a √°rea de transfer√™ncia!');
        }

        function imprimirTese() {
            window.print();
        }

        // ========== FUN√á√ïES DE BACKUP ==========
        function exportBackup() {
            const dados = {
                sistema: 'Sistema Jur√≠dico Completo',
                versao: '2.0',
                dataBackup: new Date().toISOString(),
                clientes: DB.clientes,
                processos: DB.processos,
                andamentos: DB.andamentos,
                teses: DB.teses
            };
            
            const blob = new Blob([JSON.stringify(dados, null, 2)], { 
                type: 'application/json' 
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'backup_juridico_' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('üíæ Backup gerado com sucesso!');
        }

        function importBackup() {
            document.getElementById('backup-file').click();
        }

        document.getElementById('backup-file').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    
                    if (confirm('‚ö†Ô∏è Isso substituir√° todos os dados atuais. Continuar?')) {
                        DB.clientes = dados.clientes || [];
                        DB.processos = dados.processos || [];
                        DB.andamentos = dados.andamentos || [];
                        DB.teses = dados.teses || {
                            inicial: {},
                            impugnacao: {},
                            recurso: {}
                        };
                        DB.salvar();
                        
                        alert('‚úÖ Backup importado com sucesso!');
                        atualizarEstatisticas();
                    }
                } catch (error) {
                    alert('‚ùå Erro ao importar backup. Arquivo inv√°lido.');
                }
            };
            reader.readAsText(file);
            
            // Limpar input
            event.target.value = '';
        });

        // ========== FUN√á√ïES AUXILIARES ==========
        function atualizarEstatisticas() {
            document.getElementById('total-clientes').textContent = DB.clientes.length;
            document.getElementById('total-processos').textContent = DB.processos.length;
            
            // Atualizar estat√≠sticas por √°rea
            const areas = ['Trabalhista', 'C√≠vel', 'Consumidor', 'Previdenci√°rio', 'Fam√≠lia', 'Criminal', 'Outros'];
            areas.forEach(area => {
                const quantidade = DB.processos.filter(p => p.tipo === area).length;
                document.getElementById('processos-' + area.toLowerCase()).textContent = quantidade;
            });
        }

        // ========== INICIALIZA√á√ÉO ==========
        function inicializarSistema() {
            // Configurar data atual como padr√£o
            document.getElementById('processo-data').valueAsDate = new Date();
            
            // Gerar c√≥digo inicial para cliente
            document.getElementById('cliente-codigo').value = DB.gerarCodigoCliente();
            
            atualizarEstatisticas();
            console.log('üöÄ Sistema Jur√≠dico carregado!');
        }

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', inicializarSistema);
    </script>
</body>
</html>