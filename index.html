<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Jur√≠dico Completo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* === ESTILOS GLOBAIS === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html, body {
            min-height: 100% !important;
            height: 100% !important;
            margin: 0 !important;
            padding: 0 !important;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3a8a, #2F5496) fixed;
            background-attachment: fixed;
            background-size: cover;
            background-repeat: no-repeat;
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            background: transparent !important;
        }
        
        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .propaganda-area {
                display: none;
            }
        }
        
        .container { 
            max-width: 100%;
            background: transparent !important;
        }
        
        /* === COMPONENTES DE LAYOUT === */
        .header {
            text-align: center;
            padding: 25px;
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .header h1, .header p { color: white; }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 25px;
            margin: 15px 0;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border: 1px solid #eaeaea;
            backdrop-filter: blur(10px);
        }
        
        .data-item {
            background: #f8fafc;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #2F5496;
            transition: transform 0.2s;
        }
        
        .data-item:hover { transform: translateX(5px); }
        
        .search-box {
            background: #e3f2fd;
            padding: 18px;
            border-radius: 10px;
            margin: 12px 0;
        }
        
        /* === FORMUL√ÅRIOS EM DUAS COLUNAS === */
        .form-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .form-container {
                grid-template-columns: 1fr;
            }
        }
        
        .form-left {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .form-right {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .cadastro-item {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #2F5496;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .cadastro-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .cadastro-acoes {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        /* === COMPONENTES DE FORMUL√ÅRIO === */
        .form-group { margin: 12px 0; }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2F5496;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #2F5496;
            outline: none;
        }
        
        /* === COMPONENTES DE BOT√ÉO === */
        .btn {
            background: #2F5496;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 14px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            width: 100%;
            display: block;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn-danger { background: #dc3545; }
        .btn-success { background: #28a745; }
        .btn-warning { background: #ffc107; color: #000; }
        .btn-info { background: #17a2b8; }
        .btn-secondary { background: #6c757d; }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
            width: auto;
            display: inline-block;
            margin: 2px;
        }
        
        .btn-atualizar {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            width: auto;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-atualizar:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* === LAYOUT RESPONSIVO === */
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .clientes-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 12px 0;
        }
        
        .processos-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 12px 0;
            justify-content: space-between;
        }
        
        .teses-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
        }
        
        .container-botoes {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            gap: 15px;
        }
        
        .botoes-direita {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .botoes-internos {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eaeaea;
        }
        
        .botoes-internos .btn {
            margin: 5px 0;
            font-size: 13px;
            padding: 10px 15px;
        }
        
        /* === COMPONENTES ESPEC√çFICOS === */
        .stat-card {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 14px;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #2F5496;
        }
        
        .processo-card {
            background: #e8f5e8;
            padding: 12px 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 12px;
            flex: 1;
            min-width: 80px;
        }
        
        .processo-number {
            font-size: 16px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .tese-card {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
        }
        
        .tese-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .tese-selecao {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .lista-clientes {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .cliente-item {
            background: #f8f9fa;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border-left: 4px solid #2F5496;
            font-size: 13px;
        }
        
        .cliente-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .cliente-codigo {
            background: #2F5496;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .total-clientes {
            background: #e3f2fd;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .total-clientes .numero {
            font-size: 24px;
            font-weight: bold;
            color: #2F5496;
        }
        
        /* === UTILIT√ÅRIOS === */
        .alert {
            padding: 12px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .print-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: 600;
        }
        
        .print-btn:hover { background: #5a6268; }
        
        /* === RODAP√â === */
        .footer {
            padding: 20px;
            color: white;
            margin-top: 30px;
            font-size: 14px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        /* === C√ìDIGO GERADO === */
        .codigo-gerado {
            background: #2F5496;
            color: white;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        /* === BUSCA DE CLIENTE === */
        .busca-cliente-container {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .busca-cliente-container input {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .busca-cliente-container button {
            padding: 10px 15px;
            background: #2F5496;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-lupa {
            background: #17a2b8 !important;
            padding: 10px 15px !important;
        }
        
        /* === √ÅREA DE PROPAGANDAS === */
        .propaganda-area {
            position: sticky;
            top: 20px;
            height: fit-content;
        }
        
        .propaganda-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #2F5496;
        }
        
        .propaganda-title {
            color: #2F5496;
            text-align: center;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .propaganda-content {
            text-align: center;
        }
        
        .propaganda-image {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
            max-height: 200px;
            object-fit: cover;
        }
        
        .btn-curso {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .btn-curso:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        /* === MODAIS === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            padding: 20px;
        }
        
        .modal-container {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #1e3a8a, #2F5496);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .btn-fechar-modal {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-fechar-modal:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        .modal-body {
            padding: 0;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .modal-toolbar {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .modal-content-container {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            background: #f8f9fa;
            max-height: 60vh;
        }
        
        .modal-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            color: #333;
            background: white;
            padding: 20px;
            border-radius: 5px;
            border-left: 4px solid #2F5496;
            max-height: 50vh;
            overflow-y: auto;
        }
        
        .modal-footer {
            background: white;
            padding: 20px;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }
        
        /* MODAL DE SENHA */
        .modal-senha {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            padding: 20px;
        }
        
        .modal-conteudo {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 400px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: modalEntrada 0.3s ease-out;
        }
        
        @keyframes modalEntrada {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-titulo {
            color: #1e3a8a;
            margin-bottom: 15px;
            font-size: 24px;
        }
        
        .modal-descricao {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .senha-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #2F5496;
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            letter-spacing: 2px;
            margin-bottom: 20px;
            outline: none;
            transition: all 0.3s;
        }
        
        .senha-input:focus {
            border-color: #1e3a8a;
            box-shadow: 0 0 0 3px rgba(47, 84, 150, 0.2);
        }
        
        .modal-botoes {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .btn-modal {
            padding: 12px 25px;
            min-width: 120px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-modal-primario {
            background: #2F5496;
            color: white;
        }
        
        .btn-modal-primario:hover {
            background: #1e3a8a;
            transform: translateY(-2px);
        }
        
        .btn-modal-secundario {
            background: #6c757d;
            color: white;
        }
        
        .btn-modal-secundario:hover {
            background: #5a6268;
        }
        
        .contato-admin {
            margin-top: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            font-size: 14px;
            color: #333;
        }
        
        .contato-admin strong {
            color: #dc3545;
            display: block;
            margin-bottom: 5px;
        }
        
        .senha-erro {
            color: #dc3545;
            font-weight: 600;
            margin-top: 10px;
            display: none;
        }
        
        /* === MODAL DE REGISTRO === */
        .modal-registro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3a8a, #2F5496);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            padding: 20px;
        }
        
        .modal-registro-conteudo {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 500px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: modalEntrada 0.5s ease-out;
        }
        
        .registro-titulo {
            color: #1e3a8a;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .registro-subtitulo {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .registro-requisito {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: left;
            font-size: 14px;
        }
        
        .registro-requisito strong {
            color: #1e3a8a;
            display: block;
            margin-bottom: 8px;
        }
        
        .registro-obs {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            text-align: center;
        }
        
        .registro-sucesso {
            display: none;
            padding: 20px;
            background: #d4edda;
            border-radius: 10px;
            margin: 20px 0;
            color: #155724;
        }
        
        .registro-erro {
            display: none;
            padding: 15px;
            background: #f8d7da;
            border-radius: 8px;
            margin: 15px 0;
            color: #721c24;
        }
        
        .registro-loading {
            display: none;
            margin: 20px 0;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2F5496;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* === MODAL DE TESE === */
        .modal-tese {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-tese-conteudo {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease-out;
        }
        
        /* FEEDBACK DE C√ìPIA */
        .feedback-copia {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 10002;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideInRight 0.3s ease-out;
        }
        
        .feedback-success {
            background: #28a745;
        }
        
        .feedback-danger {
            background: #dc3545;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* === ANIMA√á√ÉO DE TREME === */
        @keyframes tremer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
        
        .treme {
            animation: tremer 0.5s;
        }
        
        /* === FEEDBACK VISUAL === */
        .feedback-mensagem {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* === ESTILO PARA IMPRESS√ÉO TXT === */
        @media print {
            .no-print { display: none !important; }
            body { 
                background: white !important; 
                color: black !important;
                font-family: 'Courier New', monospace !important;
                font-size: 10pt !important;
                line-height: 1.2 !important;
                padding: 10px !important;
            }
            
            .card { 
                box-shadow: none !important; 
                border: 1px solid #000 !important;
                padding: 10px !important;
                margin: 5px 0 !important;
                page-break-inside: avoid !important;
            }
            
            .data-item {
                border: 1px solid #000 !important;
                padding: 8px !important;
                margin: 5px 0 !important;
                background: white !important;
            }
            
            h1, h2, h3, h4 {
                font-family: 'Courier New', monospace !important;
                margin: 5px 0 !important;
            }
            
            .btn, .btn-row, .modal-toolbar, .modal-footer {
                display: none !important;
            }
            
            pre, .modal-content {
                font-family: 'Courier New', monospace !important;
                font-size: 10pt !important;
                white-space: pre-wrap !important;
                background: white !important;
                border: none !important;
                padding: 0 !important;
            }
        }
        
        /* === RESULTADOS DE CONSULTA === */
        .resultados-container {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 10px;
        }
        
        /* === BOT√ÉO VER RESPOSTAS === */
        .btn-ver-respostas {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s;
        }
        
        .btn-ver-respostas:hover {
            background: #138496;
            transform: translateY(-1px);
        }
        
        /* === CONTATOS RESPOSTA === */
        .contato-resposta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        @media (max-width: 768px) {
            .contato-resposta {
                grid-template-columns: 1fr;
            }
        }
        
        /* === NOVO ESTILO PARA GRUPO SECRETO === */
        .grupo-secreto-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            padding: 40px 20px;
            text-align: center;
        }
        
        .qr-code-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 500px;
            width: 100%;
        }
        
        .qr-code-title {
            color: #2F5496;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .qr-code-image {
            width: 250px;
            height: 250px;
            margin: 20px auto;
            border: 2px solid #2F5496;
            border-radius: 10px;
            padding: 10px;
            background: white;
        }
        
        .whatsapp-link {
            display: inline-block;
            background: #25D366;
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 18px;
            margin: 20px 0;
            transition: all 0.3s;
        }
        
        .whatsapp-link:hover {
            background: #1da851;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }
        
        .grupo-instructions {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            max-width: 600px;
        }
        
        /* === UTILIT√ÅRIOS === */
        .alert {
            padding: 12px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* === RESPONSIVIDADE === */
        @media (max-width: 768px) {
            .clientes-container { grid-template-columns: 1fr; }
            .modal-registro-conteudo { padding: 25px; }
            .modal-container {
                width: 95%;
                max-height: 85vh;
            }
            .modal-footer {
                flex-direction: column;
            }
            .modal-toolbar {
                flex-wrap: wrap;
            }
            .modal-content {
                padding: 15px;
                font-size: 12px;
            }
            .grupo-secreto-container {
                padding: 20px 10px;
            }
            .qr-code-image {
                width: 200px;
                height: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .modal-header h3 {
                font-size: 1.2rem;
            }
            .btn-fechar-modal {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
            .qr-code-image {
                width: 180px;
                height: 180px;
            }
            .whatsapp-link {
                padding: 12px 20px;
                font-size: 16px;
            }
        }
        
        /* === CORRE√á√ÉO PARA DISPOSITIVOS M√ìVEIS === */
        @media (max-width: 768px) {
            body {
                background: linear-gradient(135deg, #1e3a8a, #2F5496) fixed !important;
                background-attachment: fixed !important;
                min-height: 100vh !important;
                height: auto !important;
                padding: 15px !important;
            }
            
            .main-container {
                background: transparent !important;
            }
            
            .card {
                background: rgba(255, 255, 255, 0.95) !important;
                backdrop-filter: blur(10px) !important;
                padding: 20px 15px !important;
            }
            
            .header {
                background: rgba(255, 255, 255, 0.2) !important;
                backdrop-filter: blur(10px) !important;
                padding: 20px 15px !important;
            }
            
            #dashboard .card:last-child {
                background: rgba(255, 255, 255, 0.95) !important;
                backdrop-filter: blur(10px) !important;
            }
            
            .modal-container {
                background: rgba(255, 255, 255, 0.98) !important;
            }
            
            .btn {
                padding: 12px 15px !important;
                font-size: 14px !important;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr !important;
                gap: 10px !important;
            }
            
            .processos-grid {
                justify-content: center !important;
                gap: 8px !important;
            }
            
            .processo-card {
                min-width: 100px !important;
                padding: 10px 5px !important;
            }
            
            .btn-row {
                flex-direction: column !important;
                gap: 8px !important;
            }
            
            .form-container {
                gap: 15px !important;
            }
            
            .form-left, .form-right {
                padding: 15px !important;
            }
        }
        
        /* === CORRE√á√ÉO PARA TELAS MUITO PEQUENAS === */
        @media (max-width: 375px) {
            body {
                padding: 10px !important;
            }
            
            .card {
                padding: 15px 10px !important;
            }
            
            .header {
                padding: 15px 10px !important;
            }
            
            .header h1 {
                font-size: 1.5rem !important;
            }
            
            .btn {
                padding: 10px 12px !important;
                font-size: 13px !important;
            }
            
            .stat-number {
                font-size: 20px !important;
            }
            
            .processo-number {
                font-size: 14px !important;
            }
        }
        
        /* === GARANTIR QUE OS ELEMENTOS FILHOS N√ÉO HERDEM FUNDO === */
        .main-container, .container, .card, .header, .data-item,
        .search-box, .form-left, .form-right, .cadastro-item {
            background: transparent !important;
        }
        
        /* === CORRE√á√ÉO ESPEC√çFICA PARA CARDS === */
        .card {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px) !important;
        }
        
        /* === CORRE√á√ÉO ESPEC√çFICA PARA BOT√ïES === */
        .btn {
            background: #2F5496 !important;
            color: white !important;
        }
        
        .btn:hover {
            background: #1e3a8a !important;
        }
        
        .btn-danger { background: #dc3545 !important; }
        .btn-success { background: #28a745 !important; }
        .btn-warning { background: #ffc107 !important; color: #000 !important; }
        .btn-info { background: #17a2b8 !important; }
        .btn-secondary { background: #6c757d !important; }
        
        /* === CORRE√á√ÉO PARA FUNDO DOS FORMUL√ÅRIOS === */
        .form-left {
            background: rgba(248, 249, 250, 0.9) !important;
        }
        
        .form-right {
            background: rgba(227, 242, 253, 0.9) !important;
        }
        
        /* === CORRE√á√ÉO PARA MODAIS === */
        .modal-overlay {
            background: rgba(0, 0, 0, 0.85) !important;
        }
        
        .modal-container {
            background: rgba(255, 255, 255, 0.98) !important;
            backdrop-filter: blur(20px) !important;
        }
        
        /* === ANIMA√á√ÉO SUAVE PARA TRANSFORMA√á√ïES === */
        .card, .btn, .data-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }
    </style>
</head>
<body>
    <!-- MODAL DE REGISTRO -->
    <div id="modalRegistro" class="modal-registro">
        <div class="modal-registro-conteudo">
            <h2 class="registro-titulo">‚öñÔ∏è Registro Obrigat√≥rio</h2>
            <p class="registro-subtitulo">
                Para acessar o Sistema Jur√≠dico Completo, √© necess√°rio realizar um cadastro r√°pido.
            </p>
            
            <div class="registro-requisito">
                <strong>üìã Por que preciso me registrar?</strong>
                <ul style="margin-left: 20px; margin-top: 8px;">
                    <li>Controle de acesso ao sistema</li>
                    <li>Estat√≠sticas de uso para melhorias</li>
                    <li>Comunica√ß√£o sobre atualiza√ß√µes</li>
                </ul>
            </div>
            
            <div id="registroErro" class="registro-erro"></div>
            <div id="registroSucesso" class="registro-sucesso"></div>
            
            <form id="formRegistro" onsubmit="return false;">
                <div class="form-group">
                    <label>Nome Completo *</label>
                    <input type="text" id="registroNome" placeholder="Seu nome completo" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="registroEmail" placeholder="seu@email.com" required>
                </div>
                
                <div class="form-group">
                    <label>WhatsApp *</label>
                    <input type="text" id="registroWhatsApp" placeholder="(11) 99999-9999" required>
                </div>
                
                <div class="form-group">
                    <label>Cidade/Estado *</label>
                    <input type="text" id="registroCidade" placeholder="Ex: S√£o Paulo/SP" required>
                </div>
                
                <div class="registro-obs">
                    Seus dados ser√£o enviados apenas para o administrador do sistema.
                </div>
                
                <div class="registro-loading" id="registroLoading">
                    <div class="spinner"></div>
                    <p style="margin-top: 10px;">Enviando dados...</p>
                </div>
                
                <div class="modal-botoes" style="margin-top: 25px;">
                    <button type="submit" class="btn-modal btn-modal-primario" onclick="registrarUsuario()">
                        ‚úÖ Registrar e Acessar Sistema
                    </button>
                </div>
                
                <div style="margin-top: 20px; font-size: 12px; color: #666;">
                    <strong>Administrador:</strong> T√∫lio Mattos - (16) 99176-7468
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL DE SENHA -->
    <div id="modalSenha" class="modal-senha">
        <div class="modal-conteudo">
            <h2 class="modal-titulo">üîí Acesso Restrito</h2>
            <p class="modal-descricao">Esta √°rea √© exclusiva para advogados da equipe. Digite a senha de acesso:</p>
            
            <input type="password" id="inputSenha" class="senha-input" placeholder="Digite a senha" autocomplete="off">
            
            <div id="mensagemErro" class="senha-erro">
                ‚ùå Senha n√£o cadastrada
            </div>
            
            <div class="modal-botoes">
                <button class="btn-modal btn-modal-primario" onclick="verificarSenha()">Acessar</button>
                <button class="btn-modal btn-modal-secundario" onclick="fecharModalSenha()">Cancelar</button>
            </div>
            
            <div class="contato-admin">
                <strong>‚ö†Ô∏è Problemas com acesso?</strong>
                Entre em contato com o administrador:<br>
                <strong>T√∫lio Mattos</strong><br>
                üìû (16) 99176-7468
            </div>
        </div>
    </div>

    <!-- MODAL DE TESE -->
    <div id="modalTese" class="modal-tese">
        <div class="modal-tese-conteudo">
            <div class="modal-header">
                <h3 id="modal-tese-titulo">Tese Jur√≠dica</h3>
                <button class="btn-fechar-modal" onclick="fecharModalTese()">‚úñ</button>
            </div>
            <div class="modal-body">
                <div class="modal-toolbar">
                    <button class="btn btn-info btn-small" onclick="copiarTeseModal()">üìã Copiar Tese</button>
                    <button class="btn btn-success btn-small" onclick="imprimirTeseModal()">üñ®Ô∏è Imprimir</button>
                </div>
                <div class="modal-content-container">
                    <pre id="modal-tese-conteudo" class="modal-content"></pre>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="fecharModalTese()">‚¨Ö Voltar para Teses</button>
                    <button class="btn btn-info" onclick="copiarTeseModal()">üìã Copiar Tese</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL GEN√âRICO PARA DETALHES -->
    <div id="modalDetalhes" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modal-detalhes-titulo">Detalhes</h3>
                <button class="btn-fechar-modal" onclick="fecharModalDetalhes()">‚úñ</button>
            </div>
            <div class="modal-body">
                <div class="modal-toolbar">
                    <button class="btn btn-info btn-small" onclick="copiarConteudoModal()">üìã Copiar</button>
                    <button class="btn btn-success btn-small" onclick="imprimirConteudoModal()">üñ®Ô∏è Imprimir</button>
                </div>
                <div class="modal-content-container">
                    <pre id="modal-detalhes-conteudo" class="modal-content"></pre>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="fecharModalDetalhes()">‚úñ Fechar</button>
                    <button class="btn btn-success" onclick="imprimirConteudoModal()">üñ®Ô∏è Imprimir</button>
                </div>
            </div>
        </div>
    </div>

    <!-- P√ÅGINA DO GRUPO SECRETO -->
    <div id="grupoSecreto" class="tab-content">
        <div class="card">
            <div class="grupo-secreto-container">
                <h2 class="qr-code-title">üîí Grupo Secreto - Acesso Exclusivo</h2>
                
                <div class="qr-code-container">
                    <h3>üì± Escaneie o QR Code para entrar no grupo</h3>
                    
                    <div class="qr-code-image">
                        <!-- QR Code ser√° carregado aqui -->
                        <img src="https://tuliomattos.github.io/advocacia5.0/imagens/qrcod.png" 
                             alt="QR Code do Grupo Secreto" 
                             style="width: 100%; height: 100%; object-fit: contain;"
                             onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=https://chat.whatsapp.com/DGv5JGM9mxi7guamcOiMP3'">
                    </div>
                    
                    <h3>üì≤ OU clique no link abaixo:</h3>
                    
                    <a href="https://chat.whatsapp.com/DGv5JGM9mxi7guamcOiMP3" 
                       target="_blank" 
                       class="whatsapp-link">
                        üì± Entrar no Grupo do WhatsApp
                    </a>
                    
                    <p style="margin-top: 10px; font-size: 14px; color: #666;">
                        Link: https://chat.whatsapp.com/DGv5JGM9mxi7guamcOiMP3
                    </p>
                </div>
                
                <div class="grupo-instructions">
                    <h3>‚ÑπÔ∏è Instru√ß√µes:</h3>
                    <ol style="text-align: left; margin: 15px 0; padding-left: 20px;">
                        <li>Use seu smartphone para escanear o QR Code acima</li>
                        <li>Ou clique no link para abrir no WhatsApp</li>
                        <li>O grupo √© exclusivo para membros autorizados</li>
                        <li>Mantenha o sigilo das informa√ß√µes compartilhadas</li>
                    </ol>
                </div>
                
                <button class="btn btn-secondary" onclick="showTab('dashboard')">
                    ‚Ü©Ô∏è Voltar ao Dashboard
                </button>
            </div>
        </div>
    </div>

    <!-- SISTEMA PRINCIPAL -->
    <div id="sistemaPrincipal" style="display: none;">
        <div class="main-container">
            <div class="container">
                <!-- Dashboard -->
                <div id="dashboard" class="tab-content active">
                    <div class="header">
                        <h1>‚öñÔ∏è Sistema Jur√≠dico Completo</h1>
                        <p>Controle de Clientes, Processos e Teses Jur√≠dicas</p>
                    </div>

                    <div class="card">
                        <h3>üìä Dashboard</h3>
                        <div class="stats-grid" id="stats-container">
                            <!-- Stats ser√£o preenchidos via JavaScript -->
                        </div>

                        <h4 style="margin: 15px 0 10px 0; color: #2F5496;">üìà Processos por √Årea</h4>
                        <div class="processos-grid" id="processos-container">
                            <!-- Processos ser√£o preenchidos via JavaScript -->
                        </div>
                    </div>

                    <div class="card">
                        <h3>üöÄ A√ß√µes R√°pidas</h3>
                        <button class="btn" onclick="showTab('clientes')">üë§ Cadastrar Cliente</button>
                        <button class="btn" onclick="showTab('processos')">üìÅ Cadastrar Processo</button>
                        <button class="btn" onclick="showTab('andamento')">üìù Cadastrar Andamento Processual</button>
                        <button class="btn" onclick="showTab('consultas')">üîç Consultas</button>
                        <button class="btn" onclick="showTab('relatorios')">üìä Relat√≥rios</button>
                        <button class="btn" onclick="showTab('backups')">üíæ Backups</button>
                        <button class="btn btn-info" onclick="showTab('teses')">üìö Cadastro de Teses</button>
                        <button class="btn btn-warning" onclick="executarAutoReparo()">üõ†Ô∏è Sistema de Auto-Reparo</button>
                        <button class="btn btn-secondary" onclick="showTab('grupoSecreto')">üîí Grupo Secreto</button>
                    </div>
                </div>

                <!-- Cadastro de Clientes -->
                <div id="clientes" class="tab-content">
                    <div class="card">
                        <h3>üë§ Cadastro de Clientes</h3>
                        
                        <div class="form-container">
                            <div class="form-left">
                                <div class="codigo-gerado" id="codigo-cliente">
                                    C√≥digo: Gerando...
                                </div>
                                
                                <div class="form-group">
                                    <label>C√≥digo do Cliente:</label>
                                    <input type="text" id="cliente-codigo" readonly style="background-color: #f0f0f0; font-weight: bold;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Nome Completo *</label>
                                    <input type="text" id="cliente-nome" placeholder="Nome completo do cliente" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>Sexo</label>
                                    <select id="cliente-sexo">
                                        <option value="">Selecione</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Feminino">Feminino</option>
                                        <option value="Outro">Outro</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>CPF</label>
                                    <input type="text" id="cliente-cpf" placeholder="000.000.000-00" oninput="formatarCPF(this)">
                                </div>
                                
                                <div class="form-group">
                                    <label>RG</label>
                                    <input type="text" id="cliente-rg" placeholder="00.000.000-0" oninput="formatarRG(this)">
                                </div>
                                
                                <div class="form-group">
                                    <label>Telefone/WhatsApp</label>
                                    <input type="text" id="cliente-telefone" placeholder="(11) 99999-9999" oninput="formatarTelefone(this)">
                                </div>
                                
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" id="cliente-email" placeholder="cliente@email.com">
                                </div>
                                
                                <div class="form-group">
                                    <label>Endere√ßo Completo</label>
                                    <input type="text" id="cliente-endereco" placeholder="Rua, n√∫mero, bairro, cidade">
                                </div>
                                
                                <div class="form-group">
                                    <label>Observa√ß√µes</label>
                                    <textarea id="cliente-observacoes" placeholder="Observa√ß√µes importantes..." rows="3"></textarea>
                                </div>
                                
                                <div class="btn-row">
                                    <button class="btn btn-success" onclick="salvarCliente()">üíæ Salvar Cliente</button>
                                    <button class="btn" onclick="limparFormularioCliente()">üóëÔ∏è Limpar Formul√°rio</button>
                                    <button class="btn btn-atualizar" onclick="atualizarListaClientesDireita()">üîÑ Atualizar Lista</button>
                                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                                </div>
                            </div>
                            
                            <div class="form-right">
                                <h4>üìã Clientes Cadastrados</h4>
                                <div id="lista-clientes-direita">
                                    <!-- Lista de clientes ser√° carregada aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cadastro de Processos -->
                <div id="processos" class="tab-content">
                    <div class="card">
                        <h3>üìÅ Cadastrar Processo</h3>
                        
                        <div class="form-container">
                            <div class="form-left">
                                <div class="form-group">
                                    <label>C√≥digo do Cliente *</label>
                                    <div class="busca-cliente-container">
                                        <input type="text" id="processo-cliente-codigo" placeholder="C√≥digo do cliente (Ex: 0001)" required>
                                        <button class="btn-lupa" onclick="buscarClienteComLupa('processo')">üîç</button>
                                        <button onclick="buscarClienteParaProcesso()">Buscar</button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>Cliente Encontrado:</label>
                                    <input type="text" id="cliente-processo-info" readonly style="background-color: #f0f0f0;">
                                </div>
                                
                                <div class="form-group">
                                    <label>N√∫mero do Processo *</label>
                                    <input type="text" id="processo-numero" placeholder="Ex: 2024.001.0001" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>Tipo do Processo *</label>
                                    <select id="processo-tipo" required>
                                        <option value="">Selecione o tipo</option>
                                        <option value="Trabalhista">Trabalhista</option>
                                        <option value="C√≠vel">C√≠vel</option>
                                        <option value="Consumidor">Consumidor</option>
                                        <option value="Previdenci√°rio">Previdenci√°rio</option>
                                        <option value="Fam√≠lia">Fam√≠lia</option>
                                        <option value="Criminal">Criminal</option>
                                        <option value="Outros">Outros</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Local do Processo</label>
                                    <input type="text" id="processo-local" placeholder="Ex: F√≥rum Central">
                                </div>
                                
                                <div class="form-group">
                                    <label>Data de In√≠cio</label>
                                    <input type="date" id="processo-data">
                                </div>
                                
                                <div class="form-group">
                                    <label>Valor da Causa</label>
                                    <input type="text" id="processo-valor" placeholder="R$ 0,00" oninput="formatarMoeda(this)">
                                </div>
                                
                                <div class="form-group">
                                    <label>Status</label>
                                    <select id="processo-status">
                                        <option value="Ativo">Ativo</option>
                                        <option value="Arquivado">Arquivado</option>
                                        <option value="Conclu√≠do">Conclu√≠do</option>
                                        <option value="Suspenso">Suspenso</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Resumo do Processo *</label>
                                    <textarea id="processo-resumo" placeholder="Descreva detalhadamente o processo..." rows="5" required></textarea>
                                </div>
                                
                                <div class="btn-row">
                                    <button class="btn btn-success" onclick="salvarProcesso()">üíæ Salvar Processo</button>
                                    <button class="btn" onclick="limparFormularioProcesso()">üóëÔ∏è Limpar Formul√°rio</button>
                                    <button class="btn btn-atualizar" onclick="atualizarListaProcessosDireita()">üîÑ Atualizar Lista</button>
                                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                                </div>
                            </div>
                            
                            <div class="form-right">
                                <h4>üìÅ Processos Cadastrados</h4>
                                <div id="lista-processos-direita">
                                    <!-- Lista de processos ser√° carregada aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Andamento Processual -->
                <div id="andamento" class="tab-content">
                    <div class="card">
                        <h3>üìù Cadastrar Andamento Processual</h3>
                        
                        <div class="form-container">
                            <div class="form-left">
                                <div class="busca-cliente-container">
                                    <input type="text" id="buscar-cliente-andamento" placeholder="Buscar cliente por c√≥digo ou CPF">
                                    <button class="btn-lupa" onclick="buscarClienteComLupa('andamento')">üîç</button>
                                    <button onclick="buscarClienteParaAndamento()">Buscar</button>
                                </div>
                                
                                <div class="form-group">
                                    <label>Cliente Selecionado:</label>
                                    <input type="text" id="cliente-selecionado" readonly style="background-color: #f0f0f0;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Selecione o Processo:</label>
                                    <select id="andamento-processo">
                                        <option value="">Selecione um processo</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Data do Andamento:</label>
                                    <input type="date" id="andamento-data">
                                </div>
                                
                                <div class="form-group">
                                    <label>Tipo de Andamento:</label>
                                    <select id="andamento-tipo">
                                        <option value="Peti√ß√£o">Peti√ß√£o</option>
                                        <option value="Decis√£o">Decis√£o</option>
                                        <option value="Audi√™ncia">Audi√™ncia</option>
                                        <option value="Cita√ß√£o">Cita√ß√£o</option>
                                        <option value="Intima√ß√£o">Intima√ß√£o</option>
                                        <option value="Senten√ßa">Senten√ßa</option>
                                        <option value="Recurso">Recurso</option>
                                        <option value="Outros">Outros</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Descri√ß√£o do Andamento *</label>
                                    <textarea id="novo-andamento" placeholder="Descreva o novo andamento, atualiza√ß√µes, decis√µes judiciais, prazos, etc..." rows="5" required></textarea>
                                </div>
                                
                                <div class="btn-row">
                                    <button class="btn btn-success" onclick="adicionarAndamento()">‚ûï Adicionar Andamento</button>
                                    <button class="btn" onclick="limparFormularioAndamento()">üóëÔ∏è Limpar Formul√°rio</button>
                                    <button class="btn btn-atualizar" onclick="atualizarListaProcessosAtualizados()">üîÑ Atualizar Lista</button>
                                    <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                                </div>
                            </div>
                            
                            <div class="form-right">
                                <h4>üîÑ √öltimos Processos Atualizados</h4>
                                <div id="lista-processos-atualizados">
                                    <!-- Lista dos √∫ltimos processos com andamento ser√° carregada aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Consultas -->
                <div id="consultas" class="tab-content">
                    <div class="card">
                        <h3>üîç Consultas</h3>
                        
                        <div class="search-box">
                            <h4>üìã Consultar Clientes</h4>
                            <div class="form-group">
                                <input type="text" id="consulta-cliente" placeholder="Digite c√≥digo, nome ou CPF..." onkeypress="if(event.key === 'Enter') consultarClientes()">
                            </div>
                            <button class="btn" onclick="consultarClientes()">üîç Buscar Clientes</button>
                            <button class="btn" onclick="listarTodosClientes()">üìÑ Listar Todos</button>
                            <button class="btn btn-atualizar" onclick="atualizarConsultas()">üîÑ Atualizar Dados</button>
                        </div>
                        
                        <div id="resultados-consulta-clientes" class="resultados-container"></div>
                        
                        <div class="search-box">
                            <h4>üìÅ Consultar Processos</h4>
                            <div class="form-group">
                                <input type="text" id="consulta-processo" placeholder="Digite n√∫mero, tipo ou cliente..." onkeypress="if(event.key === 'Enter') consultarProcessos()">
                            </div>
                            <button class="btn" onclick="consultarProcessos()">üîç Buscar Processos</button>
                            <button class="btn" onclick="listarTodosProcessos()">üìÑ Listar Todos</button>
                        </div>
                        
                        <div id="resultados-consulta-processos" class="resultados-container"></div>
                        
                        <div class="btn-row">
                            <button class="btn btn-atualizar" onclick="limparConsultas()">üóëÔ∏è Limpar Consultas</button>
                            <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                        </div>
                    </div>
                </div>

                <!-- Relat√≥rios -->
                <div id="relatorios" class="tab-content">
                    <div class="card">
                        <h3>üìä Relat√≥rios</h3>
                        
                        <div class="btn-row" style="margin-bottom: 20px;">
                            <button class="btn btn-atualizar" onclick="atualizarRelatoriosCompleto()">üîÑ Atualizar Estat√≠sticas</button>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number" id="rel-clientes-ativos">0</div>
                                <p>Clientes Ativos</p>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="rel-processos-ativos">0</div>
                                <p>Processos Ativos</p>
                            </div>
                        </div>
                        
                        <button class="btn" onclick="gerarRelatorioClientesAlfabetico()">üë§ Clientes (Ordem Alfab√©tica)</button>
                        <button class="btn" onclick="gerarRelatorioClientesProcesso()">‚öñÔ∏è Clientes por Processo</button>
                        
                        <div class="search-box">
                            <h4>üîç Relat√≥rio Cliente Espec√≠fico</h4>
                            <div class="form-group">
                                <input type="text" id="relatorio-cliente-especifico" placeholder="Digite c√≥digo ou CPF do cliente">
                            </div>
                            <button class="btn" onclick="gerarRelatorioClienteEspecifico()">üìã Gerar Relat√≥rio</button>
                        </div>
                        
                        <button class="btn" onclick="gerarRelatorioProcessosDetalhado()">üìÅ Processos Detalhados</button>
                        
                        <div id="relatorio-conteudo" class="resultados-container"></div>
                        
                        <div class="btn-row">
                            <button class="btn btn-success print-btn" onclick="imprimirRelatorio()">üñ®Ô∏è Imprimir Relat√≥rio</button>
                            <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                        </div>
                    </div>
                </div>

                <!-- Backups -->
                <div id="backups" class="tab-content">
                    <div class="card">
                        <h3>üíæ Sistema de Backups</h3>
                        
                        <div class="card">
                            <h4>üì¶ Backup de Clientes e Processos</h4>
                            <p>Exporte todos os dados de clientes, processos e andamentos para um arquivo de backup.</p>
                            <button class="btn btn-success" onclick="exportBackupClientes()">üíæ Gerar Backup de Clientes</button>
                            <button class="btn btn-warning" onclick="importBackupClientes()">üì• Importar Backup de Clientes</button>
                        </div>
                        
                        <div class="card">
                            <h4>üìö Backup de Teses Jur√≠dicas</h4>
                            <p>Exporte todas as teses jur√≠dicas cadastradas para um arquivo de backup separado.</p>
                            <button class="btn btn-success" onclick="exportBackupTeses()">üíæ Gerar Backup de Teses</button>
                            <button class="btn btn-warning" onclick="importBackupTeses()">üì• Importar Backup de Teses</button>
                        </div>
                        
                        <div class="btn-row">
                            <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                            <button class="btn btn-atualizar" onclick="atualizarSistema()">üîÑ Atualizar Sistema</button>
                        </div>
                    </div>
                </div>

                <!-- Teses Jur√≠dicas -->
                <div id="teses" class="tab-content">
                    <div class="card">
                        <h3>üìö Cadastro de Teses Jur√≠dicas</h3>
                        
                        <div class="btn-row">
                            <button class="btn btn-danger" onclick="showTab('consultar-teses')">üîç Consultar Teses Cadastradas</button>
                        </div>
                        
                        <div class="card">
                            <h4>‚ûï Cadastrar Nova Tese</h4>
                            <div class="form-group">
                                <label>Nome da Tese:</label>
                                <input type="text" id="nova-tese-nome" placeholder="Digite o nome da nova tese">
                            </div>
                            <div class="form-group">
                                <label>Tipo de Tese:</label>
                                    <select id="nova-tese-tipo">
                                    <option value="inicial">Tese para Inicial</option>
                                    <option value="impugnacao">Tese para Impugna√ß√£o</option>
                                    <option value="recurso">Tese para Recurso</option>
                                </select>
                            </div>
                            <button class="btn btn-success" onclick="criarNovaTese()">‚ûï Criar Nova Tese</button>
                        </div>
                        
                        <div class="teses-grid">
                            <div class="tese-card">
                                <h4>üìù Teses para Inicial</h4>
                                <div class="form-group">
                                    <label>Selecione a Tese:</label>
                                    <select id="tese-inicial" onchange="mostrarFormularioTese('inicial')">
                                        <option value="">Selecione uma tese</option>
                                    </select>
                                </div>
                                <div id="formulario-tese-inicial" class="tese-form" style="display: none;">
                                    <div class="form-group">
                                        <label>Conte√∫do da Tese:</label>
                                        <textarea id="conteudo-tese-inicial" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                                    </div>
                                    <div class="btn-row">
                                        <button class="btn btn-success btn-small" onclick="salvarTese('inicial')">üíæ Salvar Tese</button>
                                        <button class="btn btn-info btn-small" onclick="carregarTeseModal('inicial')">üëÅÔ∏è Ver/Carregar Tese</button>
                                        <button class="btn btn-danger btn-small" onclick="excluirTese('inicial')">üóëÔ∏è Excluir Tese</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="tese-card">
                                <h4>‚öñÔ∏è Teses para Impugna√ß√£o</h4>
                                <div class="form-group">
                                    <label>Selecione a Tese:</label>
                                    <select id="tese-impugnacao" onchange="mostrarFormularioTese('impugnacao')">
                                        <option value="">Selecione uma tese</option>
                                    </select>
                                </div>
                                <div id="formulario-tese-impugnacao" class="tese-form" style="display: none;">
                                    <div class="form-group">
                                        <label>Conte√∫do da Tese:</label>
                                        <textarea id="conteudo-tese-impugnacao" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                                    </div>
                                    <div class="btn-row">
                                        <button class="btn btn-success btn-small" onclick="salvarTese('impugnacao')">üíæ Salvar Tese</button>
                                        <button class="btn btn-info btn-small" onclick="carregarTeseModal('impugnacao')">üëÅÔ∏è Ver/Carregar Tese</button>
                                        <button class="btn btn-danger btn-small" onclick="excluirTese('impugnacao')">üóëÔ∏è Excluir Tese</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="tese-card">
                                <h4>üìÑ Teses para Recurso</h4>
                                <div class="form-group">
                                    <label>Selecione a Tese:</label>
                                    <select id="tese-recurso" onchange="mostrarFormularioTese('recurso')">
                                        <option value="">Selecione uma tese</option>
                                    </select>
                                </div>
                                <div id="formulario-tese-recurso" class="tese-form" style="display: none;">
                                    <div class="form-group">
                                        <label>Conte√∫do da Tese:</label>
                                        <textarea id="conteudo-tese-recurso" rows="8" placeholder="Digite ou cole o conte√∫do da tese aqui..."></textarea>
                                    </div>
                                    <div class="btn-row">
                                        <button class="btn btn-success btn-small" onclick="salvarTese('recurso')">üíæ Salvar Tese</button>
                                        <button class="btn btn-info btn-small" onclick="carregarTeseModal('recurso')">üëÅÔ∏è Ver/Carregar Tese</button>
                                        <button class="btn btn-danger btn-small" onclick="excluirTese('recurso')">üóëÔ∏è Excluir Tese</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="btn-row">
                            <button class="btn btn-success" onclick="carregarTeses()">üîÑ Carregar Teses</button>
                            <button class="btn btn-atualizar" onclick="carregarTesesDireita()">üîÑ Atualizar Lista</button>
                            <button class="btn" onclick="showTab('dashboard')">‚Ü©Ô∏è Voltar ao Dashboard</button>
                        </div>
                    </div>
                </div>

                <!-- Consultar Teses -->
                <div id="consultar-teses" class="tab-content">
                    <div class="card">
                        <h3>üîç Consultar Teses Cadastradas</h3>
                        <div class="tese-selecao">
                            <div class="form-group">
                                <label>Selecione o Tipo de Tese:</label>
                                <select id="tipo-tese-consulta" onchange="carregarTesesParaConsulta()">
                                    <option value="">Selecione o tipo</option>
                                    <option value="inicial">Tese para Inicial</option>
                                    <option value="impugnacao">Tese para Impugna√ß√£o</option>
                                    <option value="recurso">Tese para Recurso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Selecione a Tese:</label>
                                <select id="tese-consulta" onchange="mostrarTeseSelecionada()">
                                    <option value="">Selecione uma tese</option>
                                </select>
                            </div>
                        </div>
                        <div id="tese-exibicao" style="display: none;">
                            <div class="card">
                                <h4 id="titulo-tese"></h4>
                                <div class="data-item">
                                    <pre id="conteudo-tese-consulta" style="white-space: pre-wrap; font-family: inherit;"></pre>
                                </div>
                                <button class="btn btn-success" onclick="copiarTeseConsulta()">üìã Copiar Tese</button>
                                <button class="print-btn" onclick="imprimirTese()">üñ®Ô∏è Imprimir Tese</button>
                            </div>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-atualizar" onclick="carregarTesesParaConsulta()">üîÑ Atualizar Lista</button>
                            <button class="btn" onclick="showTab('teses')">‚Ü©Ô∏è Voltar para Teses</button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- √ÅREA DE PROPAGANDAS -->
            <div class="propaganda-area" id="propagandaContainer" style="display: none;">
                <div class="propaganda-card">
                    <h3 class="propaganda-title">üéì Cursos em Destaque</h3>
                    <div class="propaganda-content" id="propaganda-conteudo">
                        <!-- Propagandas ser√£o carregadas aqui -->
                    </div>
                </div>
                
                <!-- NOVO QUADRO ADICIONADO AQUI -->
                <div class="propaganda-card" style="margin-top: 20px;">
                    <h3 class="propaganda-title">üé¨ Tutorial do Sistema</h3>
                    <div class="propaganda-content">
                        <p style="margin-bottom: 15px; font-size: 14px;">
                            Aprenda a usar todas as funcionalidades do sistema de cadastro jur√≠dico.
                        </p>
                        <div class="tutorial-thumbnail" style="margin-bottom: 15px;">
                            <img src="https://img.youtube.com/vi/_DZevF1-Q10/maxresdefault.jpg" 
                                 alt="Tutorial do Sistema"
                                 style="width: 100%; border-radius: 8px; cursor: pointer;"
                                 onclick="abrirVideoTutorial()">
                        </div>
                        <a href="https://youtu.be/_DZevF1-Q10" target="_blank" style="text-decoration: none;">
                            <button class="btn-curso" style="background: linear-gradient(135deg, #FF0000, #CC0000);">
                                ‚ñ∂Ô∏è Assistir Tutorial no YouTube
                            </button>
                        </a>
                        <p style="margin-top: 10px; font-size: 12px; color: #666;">
                            Clique na imagem ou no bot√£o para assistir
                        </p>
                    </div>
                </div>
                <!-- FIM DO NOVO QUADRO -->
            </div>
        </div>

        <!-- RODAP√â ATUALIZADO -->
        <div class="footer">
            <p>2026 T√∫lio Mattos - Todos os direitos reservados</p>
        </div>

        <!-- File Inputs para Importar Backup -->
        <input type="file" id="backup-file-clientes" accept=".json" style="display: none;">
        <input type="file" id="backup-file-teses" accept=".json" style="display: none;">
    </div>

    <script>
        // ========== CONFIGURA√á√ÉO DA SENHA ==========
        const SENHA_CORRETA = "usuarioadv1010";
        let senhaDigitada = false;

        // ========== CONFIGURA√á√ÉO DO REGISTRO ==========
        const GOOGLE_SHEETS_URL = "https://script.google.com/macros/s/AKfycbzwW8iVM4-h5TbMaD2vOY-vimqVV0G7OBiJ699_Qp3bPK9ta523vCGYMPKPq05PbNY/exec";
        const EMAIL_ADMIN = "tuliomattos@email.com";

        // ========== SISTEMA DE BANCO DE DADOS ==========
        const DB = {
            clientes: JSON.parse(localStorage.getItem('sistema_juridico_clientes')) || [],
            processos: JSON.parse(localStorage.getItem('sistema_juridico_processos')) || [],
            andamentos: JSON.parse(localStorage.getItem('sistema_juridico_andamentos')) || [],
            teses: JSON.parse(localStorage.getItem('sistema_juridico_teses')) || { inicial: {}, impugnacao: {}, recurso: {} },
            usuarioRegistrado: localStorage.getItem('sistema_juridico_usuario_registrado') === 'true',
            
            salvar: function() {
                localStorage.setItem('sistema_juridico_clientes', JSON.stringify(this.clientes));
                localStorage.setItem('sistema_juridico_processos', JSON.stringify(this.processos));
                localStorage.setItem('sistema_juridico_andamentos', JSON.stringify(this.andamentos));
                localStorage.setItem('sistema_juridico_teses', JSON.stringify(this.teses));
                localStorage.setItem('sistema_juridico_usuario_registrado', this.usuarioRegistrado);
                this.atualizarInterface();
            },
            
            atualizarInterface: function() {
                atualizarEstatisticas();
                if (document.getElementById('clientes')?.classList.contains('active')) {
                    atualizarListaClientesDireita();
                }
                if (document.getElementById('processos')?.classList.contains('active')) {
                    atualizarListaProcessosDireita();
                }
                if (document.getElementById('andamento')?.classList.contains('active')) {
                    atualizarListaProcessosAtualizados();
                }
                if (document.getElementById('teses')?.classList.contains('active')) {
                    carregarTeses();
                }
                if (document.getElementById('relatorios')?.classList.contains('active')) {
                    atualizarRelatorios();
                }
            },
            
            gerarCodigoCliente: function() {
                if (this.clientes.length === 0) {
                    return "0001";
                }
                
                let maxCodigo = 0;
                this.clientes.forEach(cliente => {
                    const codigoNum = parseInt(cliente.codigo) || 0;
                    if (codigoNum > maxCodigo) {
                        maxCodigo = codigoNum;
                    }
                });
                
                const novoCodigo = maxCodigo + 1;
                return novoCodigo.toString().padStart(4, '0');
            }
        };

        // ========== NOVAS FUN√á√ïES DE ATUALIZA√á√ÉO ==========
        function atualizarConsultas() {
            document.getElementById('consulta-cliente').value = '';
            document.getElementById('consulta-processo').value = '';
            
            document.getElementById('resultados-consulta-clientes').innerHTML = '';
            document.getElementById('resultados-consulta-processos').innerHTML = '';
            
            const mensagem = document.createElement('div');
            mensagem.className = 'alert alert-success';
            mensagem.innerHTML = '‚úÖ Dados de consulta atualizados! Os campos foram limpos.';
            
            const container = document.getElementById('resultados-consulta-clientes');
            container.innerHTML = '';
            container.appendChild(mensagem);
            
            document.getElementById('resultados-consulta-processos').innerHTML = '';
            
            setTimeout(() => {
                if (mensagem.parentNode) {
                    mensagem.remove();
                }
            }, 3000);
        }
        
        function atualizarRelatoriosCompleto() {
            atualizarRelatorios();
            
            document.getElementById('relatorio-conteudo').innerHTML = '';
            
            document.getElementById('relatorio-cliente-especifico').value = '';
            
            const mensagem = document.createElement('div');
            mensagem.className = 'alert alert-success';
            mensagem.innerHTML = '‚úÖ Estat√≠sticas e relat√≥rios atualizados com sucesso!';
            
            const container = document.getElementById('relatorio-conteudo');
            container.appendChild(mensagem);
            
            setTimeout(() => {
                if (mensagem.parentNode) {
                    mensagem.remove();
                }
            }, 3000);
        }

        // ========== FUN√á√ÉO PARA ABRIR V√çDEO TUTORIAL ==========
        function abrirVideoTutorial() {
            const videoUrl = "https://youtu.be/_DZevF1-Q10";
            
            // Abre em uma nova aba
            window.open(videoUrl, '_blank', 'noopener,noreferrer');
            
            // Opcional: Mostrar confirma√ß√£o
            mostrarFeedback('üé¨ Abrindo tutorial do sistema...', 'success');
        }

        // ========== FUN√á√ïES DE FORMATA√á√ÉO ==========
        function formatarCPF(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 11) value = value.substring(0, 11);
            
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            
            input.value = value;
        }

        function formatarRG(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 9) value = value.substring(0, 9);
            
            if (value.length <= 9) {
                value = value.replace(/(\d{2})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            
            input.value = value;
        }

        function formatarTelefone(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.length > 0) {
                value = '(' + value;
            }
            if (value.length > 3) {
                value = value.substring(0, 3) + ') ' + value.substring(3);
            }
            if (value.length > 10) {
                value = value.substring(0, 10) + '-' + value.substring(10);
            }
            
            input.value = value.substring(0, 15);
        }

        function formatarMoeda(input) {
            let value = input.value.replace(/\D/g, '');
            value = (value / 100).toFixed(2) + '';
            value = value.replace(".", ",");
            value = value.replace(/(\d)(\d{3})(\d{3}),/g, "$1.$2.$3,");
            value = value.replace(/(\d)(\d{3}),/g, "$1.$2,");
            
            if (value === '0,00') {
                input.value = '';
            } else {
                input.value = 'R$ ' + value;
            }
        }

        // ========== FUN√á√ïES DE DATA ==========
        function formatarDataISOparaBR(dataISO) {
            if (!dataISO) return '';
            const data = new Date(dataISO);
            if (isNaN(data.getTime())) return dataISO;
            
            const dia = data.getDate().toString().padStart(2, '0');
            const mes = (data.getMonth() + 1).toString().padStart(2, '0');
            const ano = data.getFullYear();
            
            return `${dia}/${mes}/${ano}`;
        }

        function formatarDataBRparaISO(dataBR) {
            if (!dataBR) return '';
            const partes = dataBR.split('/');
            if (partes.length !== 3) return dataBR;
            
            const dia = partes[0];
            const mes = partes[1];
            const ano = partes[2];
            
            return `${ano}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;
        }

        function getDataAtualBR() {
            const hoje = new Date();
            const dia = hoje.getDate().toString().padStart(2, '0');
            const mes = (hoje.getMonth() + 1).toString().padStart(2, '0');
            const ano = hoje.getFullYear();
            
            return `${dia}/${mes}/${ano}`;
        }

        // ========== FUN√á√ïES DE BUSCA POR C√ìDIGO ==========
        function buscarPorCodigoParcial(codigoParcial, tipo) {
            if (!codigoParcial || codigoParcial.trim() === '') {
                return tipo === 'cliente' ? DB.clientes : DB.processos;
            }
            
            const codigoLimpo = codigoParcial.replace(/\D/g, '');
            const codigoNormalizado = codigoLimpo.padStart(4, '0');
            
            if (tipo === 'cliente') {
                return DB.clientes.filter(cliente => {
                    const clienteCodigoLimpo = cliente.codigo.replace(/\D/g, '');
                    const clienteCodigoNormalizado = clienteCodigoLimpo.padStart(4, '0');
                    
                    return clienteCodigoNormalizado.includes(codigoNormalizado) ||
                           cliente.codigo.includes(codigoParcial) ||
                           cliente.nome.toLowerCase().includes(codigoParcial.toLowerCase()) ||
                           (cliente.cpf && cliente.cpf.includes(codigoParcial));
                });
            } else if (tipo === 'processo') {
                return DB.processos.filter(processo => {
                    return processo.numero.includes(codigoParcial) ||
                           processo.clienteCodigo.includes(codigoParcial) ||
                           processo.tipo.toLowerCase().includes(codigoParcial.toLowerCase()) ||
                           processo.clienteNome.toLowerCase().includes(codigoParcial.toLowerCase());
                });
            }
            
            return [];
        }

        // ========== FUN√á√ÉO DE BUSCA COM LUPA ==========
        function buscarClienteComLupa(tipo) {
            let termo = '';
            let inputCliente = null;
            
            if (tipo === 'processo') {
                termo = document.getElementById('processo-cliente-codigo').value;
                inputCliente = 'processo';
            } else if (tipo === 'andamento') {
                termo = document.getElementById('buscar-cliente-andamento').value;
                inputCliente = 'andamento';
            }
            
            const resultados = buscarPorCodigoParcial(termo, 'cliente');
            
            if (resultados.length === 0) {
                alert('Nenhum cliente encontrado!');
                return;
            }
            
            let lista = 'Clientes encontrados:\n\n';
            resultados.forEach((cliente, index) => {
                lista += `${index + 1}. ${cliente.codigo} - ${cliente.nome}`;
                if (cliente.cpf) lista += ` (CPF: ${cliente.cpf})`;
                lista += '\n';
            });
            
            const escolha = prompt(`${lista}\n\nDigite o n√∫mero do cliente desejado:`);
            if (escolha && !isNaN(escolha)) {
                const index = parseInt(escolha) - 1;
                if (index >= 0 && index < resultados.length) {
                    const cliente = resultados[index];
                    
                    if (inputCliente === 'processo') {
                        document.getElementById('processo-cliente-codigo').value = cliente.codigo;
                        document.getElementById('cliente-processo-info').value = `${cliente.codigo} - ${cliente.nome}`;
                    } else if (inputCliente === 'andamento') {
                        document.getElementById('buscar-cliente-andamento').value = cliente.codigo;
                        document.getElementById('cliente-selecionado').value = `${cliente.codigo} - ${cliente.nome}`;
                        carregarProcessosDoCliente(cliente.codigo);
                    }
                    
                    alert(`Cliente ${cliente.codigo} selecionado!`);
                }
            }
        }

        // ========== FUN√á√ïES DE MODAL ==========
        function abrirModalDetalhes(titulo, conteudo) {
            document.getElementById('modal-detalhes-titulo').textContent = titulo;
            document.getElementById('modal-detalhes-conteudo').textContent = conteudo;
            document.getElementById('modalDetalhes').style.display = 'flex';
        }

        function fecharModalDetalhes() {
            document.getElementById('modalDetalhes').style.display = 'none';
        }

        function copiarConteudoModal() {
            const conteudo = document.getElementById('modal-detalhes-conteudo').textContent;
            
            if (!conteudo.trim()) {
                mostrarFeedback('‚ùå Conte√∫do vazio!', 'danger');
                return;
            }
            
            navigator.clipboard.writeText(conteudo).then(() => {
                mostrarFeedback('‚úÖ Conte√∫do copiado para a √°rea de transfer√™ncia!', 'success');
            }).catch(err => {
                console.error('Erro ao copiar:', err);
                mostrarFeedback('‚ùå Erro ao copiar. Tente manualmente.', 'danger');
            });
        }

        function imprimirConteudoModal() {
            const titulo = document.getElementById('modal-detalhes-titulo').textContent;
            const conteudo = document.getElementById('modal-detalhes-conteudo').textContent;
            
            const janelaImpressao = window.open('', '_blank');
            janelaImpressao.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${titulo}</title>
                    <style>
                        @media print {
                            body { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                line-height: 1.2 !important;
                                padding: 10px !important;
                                background: white !important;
                                color: black !important;
                            }
                            h1 { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 14pt !important;
                                margin: 5px 0 10px 0 !important;
                            }
                            pre { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                white-space: pre-wrap !important;
                                background: white !important;
                                border: 1px solid #000 !important;
                                padding: 10px !important;
                                margin: 5px 0 !important;
                            }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <h1>${titulo}</h1>
                    <pre>${conteudo}</pre>
                    <div class="no-print" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
                        <button onclick="window.print()" style="background: #2F5496; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üñ®Ô∏è Imprimir</button>
                        <button onclick="window.close()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">‚úñ Fechar</button>
                    </div>
                </body>
                </html>
            `);
            janelaImpressao.document.close();
        }

        // ========== SISTEMA DE REGISTRO DE USU√ÅRIOS ==========
        function verificarRegistro() {
            if (!DB.usuarioRegistrado) {
                document.getElementById('modalRegistro').style.display = 'flex';
                document.getElementById('sistemaPrincipal').style.display = 'none';
            } else {
                document.getElementById('modalRegistro').style.display = 'none';
                document.getElementById('sistemaPrincipal').style.display = 'block';
                inicializarSistema();
            }
        }

        function registrarUsuario() {
            const nome = document.getElementById('registroNome').value.trim();
            const email = document.getElementById('registroEmail').value.trim();
            const whatsapp = document.getElementById('registroWhatsApp').value.trim();
            const cidade = document.getElementById('registroCidade').value.trim();
            
            if (!nome || !email || !whatsapp || !cidade) {
                mostrarErroRegistro('Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            if (!validarEmail(email)) {
                mostrarErroRegistro('Por favor, insira um email v√°lido.');
                return;
            }
            
            document.getElementById('registroLoading').style.display = 'block';
            document.getElementById('registroErro').style.display = 'none';
            
            const dadosUsuario = {
                nome: nome,
                email: email,
                whatsapp: whatsapp,
                cidade: cidade,
                primeiroAcesso: new Date().toISOString()
            };
            
            enviarParaGoogleSheets(dadosUsuario);
        }

        function enviarParaGoogleSheets(dados) {
            const params = new URLSearchParams();
            params.append('nome', dados.nome);
            params.append('email', dados.email);
            params.append('whatsapp', dados.whatsapp);
            params.append('cidade', dados.cidade);
            params.append('primeiroAcesso', dados.primeiroAcesso);
            
            const url = `${GOOGLE_SHEETS_URL}?${params.toString()}`;
            
            fetch(url, {
                method: 'GET',
                mode: 'no-cors'
            })
            .then(() => {
                finalizarRegistro(dados);
            })
            .catch(error => {
                console.log('Google Sheets falhou, tentando fallback...', error);
                enviarFallbackEmail(dados);
            });
        }

        function enviarFallbackEmail(dados) {
            const assunto = 'Novo Registro - Sistema Jur√≠dico';
            const corpo = `
Nome: ${dados.nome}
Email: ${dados.email}
WhatsApp: ${dados.whatsapp}
Cidade: ${dados.cidade}
Primeiro Acesso: ${new Date().toLocaleString()}
            `.trim();
            
            const mailtoLink = `mailto:${EMAIL_ADMIN}?subject=${encodeURIComponent(assunto)}&body=${encodeURIComponent(corpo)}`;
            window.open(mailtoLink, '_blank');
            
            finalizarRegistro(dados);
        }

        function finalizarRegistro(dados) {
            const registros = JSON.parse(localStorage.getItem('registros_usuarios') || '[]');
            registros.push({
                ...dados,
                dataRegistro: new Date().toISOString()
            });
            localStorage.setItem('registros_usuarios', JSON.stringify(registros));
            
            DB.usuarioRegistrado = true;
            DB.salvar();
            
            document.getElementById('registroLoading').style.display = 'none';
            document.getElementById('registroSucesso').innerHTML = `
                ‚úÖ <strong>Registro realizado com sucesso!</strong><br>
                Bem-vindo(a) ao Sistema Jur√≠dico Completo, ${dados.nome}.
            `;
            document.getElementById('registroSucesso').style.display = 'block';
            
            document.getElementById('formRegistro').querySelectorAll('input').forEach(input => {
                input.disabled = true;
            });
            
            setTimeout(() => {
                document.getElementById('modalRegistro').style.display = 'none';
                document.getElementById('sistemaPrincipal').style.display = 'block';
                inicializarSistema();
            }, 2000);
        }

        function mostrarErroRegistro(mensagem) {
            document.getElementById('registroErro').innerHTML = `‚ùå ${mensagem}`;
            document.getElementById('registroErro').style.display = 'block';
            document.getElementById('registroLoading').style.display = 'none';
        }

        function validarEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // ========== FUN√á√ïES DO SISTEMA DE SENHA ==========
        function abrirModalSenha() {
            const modal = document.getElementById('modalSenha');
            const inputSenha = document.getElementById('inputSenha');
            
            modal.style.display = 'flex';
            inputSenha.value = '';
            inputSenha.focus();
            
            document.getElementById('mensagemErro').style.display = 'none';
        }

        function fecharModalSenha() {
            document.getElementById('modalSenha').style.display = 'none';
            document.getElementById('inputSenha').value = '';
            document.getElementById('mensagemErro').style.display = 'none';
        }

        function verificarSenha() {
            const senha = document.getElementById('inputSenha').value;
            const mensagemErro = document.getElementById('mensagemErro');
            
            if (senha === SENHA_CORRETA) {
                senhaDigitada = true;
                fecharModalSenha();
                
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                alert('Senha correta! Redirecionando para o Grupo Secreto...');
                showTab('grupoSecreto');
            } else {
                mensagemErro.innerHTML = `‚ùå Senha n√£o cadastrada. Entre em contato com o administrador:<br><strong>T√∫lio Mattos (16) 99176-7468</strong>`;
                mensagemErro.style.display = 'block';
                document.getElementById('inputSenha').value = '';
                document.getElementById('inputSenha').focus();
                
                const input = document.getElementById('inputSenha');
                input.style.borderColor = '#dc3545';
                input.classList.add('treme');
                setTimeout(() => {
                    input.classList.remove('treme');
                }, 500);
            }
        }

        // ========== FUN√á√ïES PRINCIPAIS ==========
        function showTab(tabName) {
            const propagandaContainer = document.getElementById('propagandaContainer');
            if (tabName === 'dashboard') {
                propagandaContainer.style.display = 'block';
            } else {
                propagandaContainer.style.display = 'none';
            }
            
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            const inicializacoes = {
                'clientes': () => {
                    inicializarCadastroCliente();
                },
                'processos': () => {
                    const hoje = new Date();
                    const dia = hoje.getDate().toString().padStart(2, '0');
                    const mes = (hoje.getMonth() + 1).toString().padStart(2, '0');
                    const ano = hoje.getFullYear();
                    document.getElementById('processo-data').value = `${ano}-${mes}-${dia}`;
                    document.getElementById('processo-cliente-codigo').value = '';
                    document.getElementById('cliente-processo-info').value = '';
                    atualizarListaProcessosDireita();
                },
                'andamento': () => {
                    const hoje = new Date();
                    const dia = hoje.getDate().toString().padStart(2, '0');
                    const mes = (hoje.getMonth() + 1).toString().padStart(2, '0');
                    const ano = hoje.getFullYear();
                    document.getElementById('andamento-data').value = `${ano}-${mes}-${dia}`;
                    document.getElementById('buscar-cliente-andamento').value = '';
                    document.getElementById('cliente-selecionado').value = '';
                    atualizarListaProcessosAtualizados();
                },
                'teses': () => carregarTeses(),
                'consultar-teses': () => {
                    document.getElementById('tese-exibicao').style.display = 'none';
                },
                'consultas': () => {
                    document.getElementById('consulta-cliente').value = '';
                    document.getElementById('consulta-processo').value = '';
                    document.getElementById('resultados-consulta-clientes').innerHTML = '';
                    document.getElementById('resultados-consulta-processos').innerHTML = '';
                },
                'relatorios': () => {
                    atualizarRelatorios();
                },
                'grupoSecreto': () => {
                    if (!senhaDigitada) {
                        abrirModalSenha();
                        setTimeout(() => {
                            if (!senhaDigitada) {
                                showTab('dashboard');
                            }
                        }, 100);
                    }
                }
            };
            
            if (inicializacoes[tabName]) {
                inicializacoes[tabName]();
            }
            
            atualizarEstatisticas();
            
            if (tabName === 'dashboard') {
                atualizarPropagandas();
            }
        }

        // ========== FUN√á√ÉO PARA ATUALIZAR PROPAGANDAS ==========
        function atualizarPropagandas() {
            // Isso atualiza apenas o primeiro quadro (do curso)
            document.getElementById('propaganda-conteudo').innerHTML = `
                <h4 style="color: #2F5496; margin-bottom: 10px;">üéì Curso Advocacia 5.0</h4>
                <p style="margin-bottom: 15px; font-size: 14px;">Transforme sua advocacia com t√©cnicas modernas e eficientes.</p>
                <a href="https://tuliomattos.github.io/advocacia5.0/" target="_blank" style="text-decoration: none;">
                    <button class="btn-curso">
                        üöÄ Acessar Curso
                    </button>
                </a>
            `;
        }

        // ========== FUN√á√ïES DE CLIENTES ==========
        function inicializarCadastroCliente() {
            const novoCodigo = DB.gerarCodigoCliente();
            document.getElementById('cliente-codigo').value = novoCodigo;
            document.getElementById('codigo-cliente').textContent = `C√≥digo: ${novoCodigo}`;
            
            document.getElementById('cliente-nome').value = '';
            document.getElementById('cliente-sexo').value = '';
            document.getElementById('cliente-cpf').value = '';
            document.getElementById('cliente-rg').value = '';
            document.getElementById('cliente-telefone').value = '';
            document.getElementById('cliente-email').value = '';
            document.getElementById('cliente-endereco').value = '';
            document.getElementById('cliente-observacoes').value = '';
            
            atualizarListaClientesDireita();
        }

        function salvarCliente() {
            const codigo = document.getElementById('cliente-codigo').value;
            const nome = document.getElementById('cliente-nome').value;
            
            if (!nome) {
                alert('Por favor, preencha o nome do cliente');
                return;
            }
            
            const cliente = {
                codigo: codigo,
                nome: nome,
                sexo: document.getElementById('cliente-sexo').value,
                cpf: document.getElementById('cliente-cpf').value,
                rg: document.getElementById('cliente-rg').value,
                endereco: document.getElementById('cliente-endereco').value,
                telefone: document.getElementById('cliente-telefone').value,
                email: document.getElementById('cliente-email').value,
                observacoes: document.getElementById('cliente-observacoes').value,
                dataCadastro: getDataAtualBR(),
                status: 'Ativo'
            };
            
            DB.clientes.push(cliente);
            DB.salvar();
            
            alert(`Cliente ${codigo} - ${nome} cadastrado com sucesso!`);
            inicializarCadastroCliente();
        }

        function limparFormularioCliente() {
            inicializarCadastroCliente();
        }

        function atualizarListaClientesDireita() {
            const container = document.getElementById('lista-clientes-direita');
            if (!container) return;

            if (DB.clientes.length === 0) {
                container.innerHTML = '<div class="alert alert-danger">Nenhum cliente cadastrado ainda.</div>';
                return;
            }

            const clientesOrdenados = [...DB.clientes].sort((a, b) => {
                return parseInt(b.codigo) - parseInt(a.codigo);
            });

            let html = '';
            clientesOrdenados.forEach(cliente => {
                html += `
                    <div class="cadastro-item">
                        <div class="cadastro-header">
                            <span class="cliente-codigo">#${cliente.codigo}</span>
                            <strong>${cliente.nome}</strong>
                        </div>
                        <div class="detalhes">
                            <div>üìû ${cliente.telefone || 'N√£o informado'}</div>
                            <div>üÜî ${cliente.cpf || 'N√£o informado'}</div>
                            <div>üìß ${cliente.email || 'N√£o informado'}</div>
                            <div>üìÖ ${cliente.dataCadastro}</div>
                            <div class="cadastro-acoes">
                                <button class="btn-small btn-success" onclick="editarCliente('${cliente.codigo}')">‚úèÔ∏è Alterar</button>
                                <button class="btn-small btn-danger" onclick="excluirCliente('${cliente.codigo}')">üóëÔ∏è Excluir</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function editarCliente(codigo) {
            const cliente = DB.clientes.find(c => c.codigo === codigo);
            if (!cliente) return;

            document.getElementById('cliente-codigo').value = cliente.codigo;
            document.getElementById('codigo-cliente').textContent = `C√≥digo: ${cliente.codigo} (Editando)`;
            document.getElementById('cliente-nome').value = cliente.nome;
            document.getElementById('cliente-sexo').value = cliente.sexo || '';
            document.getElementById('cliente-cpf').value = cliente.cpf || '';
            document.getElementById('cliente-rg').value = cliente.rg || '';
            document.getElementById('cliente-telefone').value = cliente.telefone || '';
            document.getElementById('cliente-email').value = cliente.email || '';
            document.getElementById('cliente-endereco').value = cliente.endereco || '';
            document.getElementById('cliente-observacoes').value = cliente.observacoes || '';

            DB.clientes = DB.clientes.filter(c => c.codigo !== codigo);
            DB.salvar();
        }

        function excluirCliente(codigo) {
            if (confirm(`‚ö†Ô∏è Tem certeza que deseja excluir o cliente ${codigo}?\n\nEsta a√ß√£o n√£o pode ser desfeita.`)) {
                const processosCliente = DB.processos.filter(p => p.clienteCodigo === codigo);
                processosCliente.forEach(processo => {
                    DB.andamentos = DB.andamentos.filter(a => a.processoId !== processo.id);
                });
                
                DB.processos = DB.processos.filter(p => p.clienteCodigo !== codigo);
                DB.clientes = DB.clientes.filter(cliente => cliente.codigo !== codigo);
                DB.salvar();
                alert(`Cliente ${codigo} exclu√≠do com sucesso!`);
                atualizarListaClientesDireita();
            }
        }

        // ========== FUN√á√ïES DE PROCESSOS ==========
        function buscarClienteParaProcesso() {
            const codigoDigitado = document.getElementById('processo-cliente-codigo').value;
            const resultados = buscarPorCodigoParcial(codigoDigitado, 'cliente');
            
            if (resultados.length === 0) {
                document.getElementById('cliente-processo-info').value = '';
                alert('Cliente n√£o encontrado! Verifique o c√≥digo.');
                return;
            }
            
            if (resultados.length === 1) {
                const cliente = resultados[0];
                document.getElementById('cliente-processo-info').value = `${cliente.codigo} - ${cliente.nome}`;
                document.getElementById('processo-cliente-codigo').value = cliente.codigo;
                alert(`Cliente ${cliente.codigo} encontrado!`);
            } else {
                let lista = 'Clientes encontrados:\n\n';
                resultados.slice(0, 5).forEach((cliente, index) => {
                    lista += `${index + 1}. ${cliente.codigo} - ${cliente.nome}\n`;
                });
                
                if (resultados.length > 5) {
                    lista += `\n... e mais ${resultados.length - 5} cliente(s)`;
                }
                
                const escolha = prompt(`${lista}\n\nDigite o n√∫mero do cliente desejado:`);
                if (escolha && !isNaN(escolha)) {
                    const index = parseInt(escolha) - 1;
                    if (index >= 0 && index < resultados.length) {
                        const cliente = resultados[index];
                        document.getElementById('cliente-processo-info').value = `${cliente.codigo} - ${cliente.nome}`;
                        document.getElementById('processo-cliente-codigo').value = cliente.codigo;
                    }
                }
            }
        }

        function salvarProcesso() {
            let clienteCodigo = document.getElementById('processo-cliente-codigo').value;
            const numero = document.getElementById('processo-numero').value;
            const tipo = document.getElementById('processo-tipo').value;
            const resumo = document.getElementById('processo-resumo').value;
            
            if (!clienteCodigo || !numero || !tipo || !resumo) {
                alert('Por favor, preencha todos os campos obrigat√≥rios');
                return;
            }
            
            clienteCodigo = clienteCodigo.replace(/\D/g, '').padStart(4, '0');
            
            let cliente = DB.clientes.find(c => c.codigo === clienteCodigo);
            
            if (!cliente) {
                const resultados = buscarPorCodigoParcial(clienteCodigo, 'cliente');
                if (resultados.length > 0) {
                    cliente = resultados[0];
                    clienteCodigo = cliente.codigo;
                    document.getElementById('processo-cliente-codigo').value = clienteCodigo;
                    document.getElementById('cliente-processo-info').value = `${cliente.codigo} - ${cliente.nome}`;
                }
            }
            
            if (!cliente) {
                alert('Cliente n√£o encontrado! Verifique o c√≥digo.');
                return;
            }
            
            let valor = 0;
            const valorTexto = document.getElementById('processo-valor').value;
            if (valorTexto) {
                valor = parseFloat(valorTexto.replace('R$ ', '').replace('.', '').replace(',', '.'));
            }

            const dataISO = document.getElementById('processo-data').value;
            const dataBR = formatarDataISOparaBR(dataISO);

            const processo = {
                id: Date.now().toString(),
                clienteCodigo: clienteCodigo,
                clienteNome: cliente.nome,
                numero: numero,
                tipo: tipo,
                local: document.getElementById('processo-local').value,
                data: dataBR,
                valor: valor,
                status: document.getElementById('processo-status').value || 'Ativo',
                resumo: resumo,
                dataCadastro: getDataAtualBR(),
                ultimaAtualizacao: getDataAtualBR()
            };
            
            DB.processos.push(processo);
            DB.salvar();
            
            alert(`Processo ${numero} cadastrado com sucesso para o cliente ${clienteCodigo}!`);
            
            document.getElementById('processo-cliente-codigo').value = '';
            document.getElementById('cliente-processo-info').value = '';
            document.getElementById('processo-numero').value = '';
            document.getElementById('processo-tipo').value = '';
            document.getElementById('processo-local').value = '';
            document.getElementById('processo-valor').value = '';
            document.getElementById('processo-resumo').value = '';
            
            atualizarListaProcessosDireita();
            if (document.getElementById('andamento')?.classList.contains('active')) {
                atualizarListaProcessosAtualizados();
            }
        }

        function limparFormularioProcesso() {
            document.getElementById('processo-cliente-codigo').value = '';
            document.getElementById('cliente-processo-info').value = '';
            document.getElementById('processo-numero').value = '';
            document.getElementById('processo-tipo').value = '';
            document.getElementById('processo-local').value = '';
            document.getElementById('processo-valor').value = '';
            document.getElementById('processo-resumo').value = '';
        }

        function excluirProcesso(id) {
            const processo = DB.processos.find(p => p.id === id);
            if (!processo) return;
            
            if (confirm(`‚ö†Ô∏è Tem certeza que deseja excluir o processo ${processo.numero}?\n\nIsso tamb√©m excluir√° todos os andamentos relacionados.\n\nEsta a√ß√£o n√£o pode ser desfeita.`)) {
                DB.processos = DB.processos.filter(p => p.id !== id);
                DB.andamentos = DB.andamentos.filter(a => a.processoId !== id);
                DB.salvar();
                
                alert(`Processo ${processo.numero} exclu√≠do com sucesso!`);
                
                if (document.getElementById('processos')?.classList.contains('active')) {
                    atualizarListaProcessosDireita();
                }
                if (document.getElementById('andamento')?.classList.contains('active')) {
                    atualizarListaProcessosAtualizados();
                }
                atualizarEstatisticas();
            }
        }

        function atualizarListaProcessosDireita() {
            const container = document.getElementById('lista-processos-direita');
            if (!container) return;

            if (DB.processos.length === 0) {
                container.innerHTML = '<div class="alert alert-danger">Nenhum processo cadastrado ainda.</div>';
                return;
            }

            const processosOrdenados = [...DB.processos].sort((a, b) => {
                const dataA = a.ultimaAtualizacao ? a.ultimaAtualizacao : a.dataCadastro;
                const dataB = b.ultimaAtualizacao ? b.ultimaAtualizacao : b.dataCadastro;
                return new Date(formatarDataBRparaISO(dataB)) - new Date(formatarDataBRparaISO(dataA));
            });

            let html = '';
            processosOrdenados.forEach(processo => {
                const andamentosCount = DB.andamentos.filter(a => a.processoId === processo.id).length;
                html += `
                    <div class="cadastro-item">
                        <div class="cadastro-header">
                            <span class="cliente-codigo">${processo.tipo}</span>
                            <strong>${processo.numero}</strong>
                        </div>
                        <div class="detalhes">
                            <div>üë§ ${processo.clienteNome}</div>
                            <div>‚öñÔ∏è ${processo.local || 'N√£o informada'}</div>
                            <div>üìÖ ${processo.data}</div>
                            <div>üí∞ R$ ${processo.valor.toFixed(2)}</div>
                            <div>üìù ${processo.status}</div>
                            <div>üìä ${andamentosCount} andamento(s)</div>
                            <div class="cadastro-acoes">
                                <button class="btn-small btn-info" onclick="verDetalhesProcesso('${processo.id}')">üëÅÔ∏è Ver</button>
                                <button class="btn-small btn-danger" onclick="excluirProcesso('${processo.id}')">üóëÔ∏è Excluir</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // ========== FUN√á√ïES DE ANDAMENTOS ==========
        function buscarClienteParaAndamento() {
            const termo = document.getElementById('buscar-cliente-andamento').value;
            const resultados = buscarPorCodigoParcial(termo, 'cliente');
            
            if (resultados.length === 0) {
                document.getElementById('cliente-selecionado').value = '';
                alert('Cliente n√£o encontrado!');
                return;
            }
            
            if (resultados.length === 1) {
                const cliente = resultados[0];
                document.getElementById('cliente-selecionado').value = `${cliente.codigo} - ${cliente.nome}`;
                carregarProcessosDoCliente(cliente.codigo);
                alert(`Cliente ${cliente.codigo} encontrado!`);
            } else {
                let lista = 'Clientes encontrados:\n\n';
                resultados.slice(0, 5).forEach((cliente, index) => {
                    lista += `${index + 1}. ${cliente.codigo} - ${cliente.nome}\n`;
                });
                
                if (resultados.length > 5) {
                    lista += `\n... e mais ${resultados.length - 5} cliente(s)`;
                }
                
                const escolha = prompt(`${lista}\n\nDigite o n√∫mero do cliente desejado:`);
                if (escolha && !isNaN(escolha)) {
                    const index = parseInt(escolha) - 1;
                    if (index >= 0 && index < resultados.length) {
                        const cliente = resultados[index];
                        document.getElementById('cliente-selecionado').value = `${cliente.codigo} - ${cliente.nome}`;
                        document.getElementById('buscar-cliente-andamento').value = cliente.codigo;
                        carregarProcessosDoCliente(cliente.codigo);
                    }
                }
            }
        }

        function carregarProcessosDoCliente(clienteCodigo) {
            const select = document.getElementById('andamento-processo');
            select.innerHTML = '<option value="">Selecione um processo</option>';
            
            const processosCliente = DB.processos.filter(p => p.clienteCodigo === clienteCodigo);
            
            if (processosCliente.length === 0) {
                select.innerHTML += '<option value="" disabled>Este cliente n√£o possui processos</option>';
                return;
            }
            
            processosCliente.forEach(processo => {
                const andamentosCount = DB.andamentos.filter(a => a.processoId === processo.id).length;
                const option = document.createElement('option');
                option.value = processo.id;
                option.textContent = `${processo.numero} - ${processo.tipo} (${andamentosCount} andamentos)`;
                select.appendChild(option);
            });
        }

        function adicionarAndamento() {
            const processoId = document.getElementById('andamento-processo').value;
            const descricao = document.getElementById('novo-andamento').value;

            if (!processoId || !descricao) {
                alert('Selecione um processo e descreva o andamento!');
                return;
            }

            const processo = DB.processos.find(p => p.id === processoId);
            if (!processo) {
                alert('Processo n√£o encontrado!');
                return;
            }

            const dataISO = document.getElementById('andamento-data').value;
            const dataBR = formatarDataISOparaBR(dataISO);

            const andamento = {
                id: Date.now().toString(),
                processoId: processoId,
                processoNumero: processo.numero,
                clienteNome: processo.clienteNome,
                clienteCodigo: processo.clienteCodigo,
                data: dataBR,
                tipo: document.getElementById('andamento-tipo').value || 'Outros',
                descricao: descricao,
                dataRegistro: getDataAtualBR()
            };

            DB.andamentos.push(andamento);
            
            processo.ultimaAtualizacao = getDataAtualBR();
            
            DB.salvar();

            alert(`Andamento adicionado para o processo ${processo.numero}!`);
            
            const titulo = `Andamento Processual - ${processo.numero}`;
            const conteudo = `CLIENTE: ${processo.clienteNome} (${processo.clienteCodigo})
PROCESSO: ${processo.numero} - ${processo.tipo}
DATA: ${dataBR}
TIPO: ${document.getElementById('andamento-tipo').value}
DESCRI√á√ÉO:
${descricao}

Data de registro: ${getDataAtualBR()}`;
            
            abrirModalDetalhes(titulo, conteudo);
            
            document.getElementById('novo-andamento').value = '';
            atualizarListaProcessosAtualizados();
        }

        function atualizarListaProcessosAtualizados() {
            const container = document.getElementById('lista-processos-atualizados');
            if (!container) return;

            const processosComAndamentos = DB.processos
                .map(processo => {
                    const ultimoAndamento = DB.andamentos
                        .filter(a => a.processoId === processo.id)
                        .sort((a, b) => new Date(formatarDataBRparaISO(b.dataRegistro)) - new Date(formatarDataBRparaISO(a.dataRegistro)))[0];
                    
                    return {
                        ...processo,
                        ultimoAndamento: ultimoAndamento,
                        dataUltimoAndamento: ultimoAndamento ? ultimoAndamento.dataRegistro : processo.dataCadastro
                    };
                })
                .sort((a, b) => new Date(formatarDataBRparaISO(b.dataUltimoAndamento)) - new Date(formatarDataBRparaISO(a.dataUltimoAndamento)))
                .slice(0, 10);

            if (processosComAndamentos.length === 0) {
                container.innerHTML = '<div class="alert alert-danger">Nenhum processo com andamento cadastrado.</div>';
                return;
            }

            let html = '';
            processosComAndamentos.forEach(processo => {
                const andamentosCount = DB.andamentos.filter(a => a.processoId === processo.id).length;
                const ultimaAtualizacao = processo.ultimoAndamento ? 
                    `√öltimo: ${processo.ultimoAndamento.data} (${processo.ultimoAndamento.tipo})` : 
                    'Sem andamentos';
                
                html += `
                    <div class="cadastro-item">
                        <div class="cadastro-header">
                            <span class="cliente-codigo">${processo.tipo}</span>
                            <strong>${processo.numero}</strong>
                        </div>
                        <div class="detalhes">
                            <div>üë§ ${processo.clienteNome}</div>
                            <div>üìä ${andamentosCount} andamento(s)</div>
                            <div>üìÖ ${ultimaAtualizacao}</div>
                            <div class="cadastro-acoes">
                                <button class="btn-small" onclick="verAndamentosProcesso('${processo.id}')">üìù Ver</button>
                                <button class="btn-small btn-info" onclick="adicionarNovoAndamento('${processo.id}')">‚ûï Add</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function verAndamentosProcesso(id) {
            const processo = DB.processos.find(p => p.id === id);
            if (!processo) return;

            const andamentos = DB.andamentos.filter(a => a.processoId === id)
                .sort((a, b) => new Date(formatarDataBRparaISO(b.data)) - new Date(formatarDataBRparaISO(a.data)));

            let conteudo = `PROCESSO: ${processo.numero}
CLIENTE: ${processo.clienteNome} (${processo.clienteCodigo})
TIPO: ${processo.tipo}
LOCAL: ${processo.local || 'N√£o informado'}
DATA IN√çCIO: ${processo.data}
STATUS: ${processo.status}
VALOR: R$ ${processo.valor.toFixed(2)}

==============================
ANDAMENTOS PROCESSUAIS
==============================

`;

            if (andamentos.length === 0) {
                conteudo += 'Nenhum andamento cadastrado para este processo.';
            } else {
                andamentos.forEach((andamento, index) => {
                    conteudo += `ANDAMENTO ${index + 1}:
Data: ${andamento.data}
Tipo: ${andamento.tipo}
Descri√ß√£o: ${andamento.descricao}

`;
                });
            }

            abrirModalDetalhes(`Andamentos - ${processo.numero}`, conteudo);
        }

        function adicionarNovoAndamento(processoId) {
            const processo = DB.processos.find(p => p.id === processoId);
            if (!processo) return;

            document.getElementById('buscar-cliente-andamento').value = processo.clienteCodigo;
            document.getElementById('cliente-selecionado').value = `${processo.clienteCodigo} - ${processo.clienteNome}`;
            carregarProcessosDoCliente(processo.clienteCodigo);
            
            setTimeout(() => {
                document.getElementById('andamento-processo').value = processoId;
                document.getElementById('novo-andamento').focus();
            }, 100);
        }

        function limparFormularioAndamento() {
            document.getElementById('buscar-cliente-andamento').value = '';
            document.getElementById('cliente-selecionado').value = '';
            document.getElementById('andamento-processo').innerHTML = '<option value="">Selecione um processo</option>';
            document.getElementById('novo-andamento').value = '';
        }

        // ========== FUN√á√ïES DE CONSULTAS ==========
        function consultarClientes() {
            const termo = document.getElementById('consulta-cliente').value;
            const resultados = buscarPorCodigoParcial(termo, 'cliente');
            
            exibirResultadosConsultaClientes(resultados);
        }

        function listarTodosClientes() {
            exibirResultadosConsultaClientes(DB.clientes);
        }

        function exibirResultadosConsultaClientes(clientes) {
            const container = document.getElementById('resultados-consulta-clientes');
            
            if (clientes.length === 0) {
                container.innerHTML = '<div class="alert alert-danger">Nenhum cliente encontrado.</div>';
                return;
            }
            
            let html = `
                <h4>üìã Resultados da Consulta (${clientes.length} cliente(s))</h4>
                ${clientes.map(cliente => {
                    const processosCount = DB.processos.filter(p => p.clienteCodigo === cliente.codigo).length;
                    const andamentosCount = DB.processos
                        .filter(p => p.clienteCodigo === cliente.codigo)
                        .reduce((total, processo) => {
                            return total + DB.andamentos.filter(a => a.processoId === processo.id).length;
                        }, 0);
                    
                    return `
                        <div class="data-item">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${cliente.codigo} - ${cliente.nome}</strong><br>
                                    <small>CPF: ${cliente.cpf || 'N√£o informado'} | Telefone: ${cliente.telefone || 'N√£o informado'}</small>
                                </div>
                                <div class="cadastro-acoes">
                                    <button class="btn-small btn-info" onclick="verDetalhesClienteConsulta('${cliente.codigo}')">üëÅÔ∏è Ver</button>
                                    <button class="btn-small btn-danger" onclick="excluirCliente('${cliente.codigo}')">üóëÔ∏è Excluir</button>
                                </div>
                            </div>
                            <div>
                                <strong>Email:</strong> ${cliente.email || 'N√£o informado'} | 
                                <strong>Endere√ßo:</strong> ${cliente.endereco || 'N√£o informado'}
                            </div>
                            <div>
                                <strong>Processos:</strong> ${processosCount} | 
                                <strong>Andamentos:</strong> ${andamentosCount} | 
                                <strong>Cadastro:</strong> ${cliente.dataCadastro}
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
            
            container.innerHTML = html;
        }

        function verDetalhesClienteConsulta(codigo) {
            const cliente = DB.clientes.find(c => c.codigo === codigo);
            if (!cliente) return;

            const processos = DB.processos.filter(p => p.clienteCodigo === codigo);
            const andamentos = DB.andamentos.filter(a => a.clienteCodigo === codigo);

            let conteudo = `CLIENTE: ${cliente.nome}
C√ìDIGO: ${cliente.codigo}
CPF: ${cliente.cpf || 'N√£o informado'}
RG: ${cliente.rg || 'N√£o informado'}
SEXO: ${cliente.sexo || 'N√£o informado'}
TELEFONE: ${cliente.telefone || 'N√£o informado'}
EMAIL: ${cliente.email || 'N√£o informado'}
ENDERE√áO: ${cliente.endereco || 'N√£o informado'}
OBSERVA√á√ïES: ${cliente.observacoes || 'Nenhuma'}
DATA CADASTRO: ${cliente.dataCadastro}
STATUS: ${cliente.status}

==============================
PROCESSOS (${processos.length})
==============================

`;

            if (processos.length === 0) {
                conteudo += 'Nenhum processo cadastrado para este cliente.\n';
            } else {
                processos.forEach((processo, index) => {
                    const processoAndamentos = andamentos.filter(a => a.processoId === processo.id);
                    conteudo += `PROCESSO ${index + 1}:
N√∫mero: ${processo.numero}
Tipo: ${processo.tipo}
Local: ${processo.local || 'N√£o informado'}
Data: ${processo.data}
Valor: R$ ${processo.valor.toFixed(2)}
Status: ${processo.status}
Andamentos: ${processoAndamentos.length}

`;
                });
            }

            conteudo += `
==============================
ANDAMENTOS (${andamentos.length})
==============================

`;

            if (andamentos.length === 0) {
                conteudo += 'Nenhum andamento cadastrado para este cliente.';
            } else {
                andamentos.forEach((andamento, index) => {
                    conteudo += `ANDAMENTO ${index + 1}:
Processo: ${andamento.processoNumero}
Data: ${andamento.data}
Tipo: ${andamento.tipo}
Descri√ß√£o: ${andamento.descricao}

`;
                });
            }

            abrirModalDetalhes(`Cliente: ${cliente.nome}`, conteudo);
        }

        function consultarProcessos() {
            const termo = document.getElementById('consulta-processo').value;
            const resultados = buscarPorCodigoParcial(termo, 'processo');
            
            exibirResultadosConsultaProcessos(resultados);
        }

        function listarTodosProcessos() {
            exibirResultadosConsultaProcessos(DB.processos);
        }

        function exibirResultadosConsultaProcessos(processos) {
            const container = document.getElementById('resultados-consulta-processos');
            
            if (processos.length === 0) {
                container.innerHTML = '<div class="alert alert-danger">Nenhum processo encontrado.</div>';
                return;
            }
            
            let html = `
                <h4>üìÅ Resultados da Consulta (${processos.length} processo(s))</h4>
                ${processos.map(processo => {
                    const andamentosCount = DB.andamentos.filter(a => a.processoId === processo.id).length;
                    const cliente = DB.clientes.find(c => c.codigo === processo.clienteCodigo);
                    
                    return `
                        <div class="data-item">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${processo.numero} - ${processo.tipo}</strong><br>
                                    <small>Cliente: ${cliente ? cliente.nome : 'N√£o encontrado'} (${processo.clienteCodigo})</small>
                                </div>
                                <div class="cadastro-acoes">
                                    <button class="btn-small btn-info" onclick="verDetalhesProcessoConsulta('${processo.id}')">üëÅÔ∏è Ver</button>
                                    <button class="btn-small btn-danger" onclick="excluirProcesso('${processo.id}')">üóëÔ∏è Excluir</button>
                                </div>
                            </div>
                            <div>
                                <strong>Local:</strong> ${processo.local || 'N√£o informado'} | 
                                <strong>Data:</strong> ${processo.data} | 
                                <strong>Valor:</strong> R$ ${processo.valor.toFixed(2)}
                            </div>
                            <div>
                                <strong>Status:</strong> ${processo.status} | 
                                <strong>Andamentos:</strong> ${andamentosCount} | 
                                <strong>Cadastro:</strong> ${processo.dataCadastro}
                            </div>
                        </div>
                    `;
                }).join('')}
            `;
            
            container.innerHTML = html;
        }

        function verDetalhesProcessoConsulta(id) {
            const processo = DB.processos.find(p => p.id === id);
            if (!processo) return;

            const cliente = DB.clientes.find(c => c.codigo === processo.clienteCodigo);
            const andamentos = DB.andamentos.filter(a => a.processoId === id)
                .sort((a, b) => new Date(formatarDataBRparaISO(b.data)) - new Date(formatarDataBRparaISO(a.data)));

            let conteudo = `PROCESSO: ${processo.numero}
TIPO: ${processo.tipo}
CLIENTE: ${cliente ? cliente.nome : 'N√£o encontrado'} (${processo.clienteCodigo})
LOCAL: ${processo.local || 'N√£o informado'}
DATA IN√çCIO: ${processo.data}
VALOR: R$ ${processo.valor.toFixed(2)}
STATUS: ${processo.status}
RESUMO: ${processo.resumo || 'Sem descri√ß√£o'}
DATA CADASTRO: ${processo.dataCadastro}
√öLTIMA ATUALIZA√á√ÉO: ${processo.ultimaAtualizacao || processo.dataCadastro}

==============================
DADOS DO CLIENTE
==============================

Nome: ${cliente ? cliente.nome : 'N√£o encontrado'}
CPF: ${cliente ? cliente.cpf || 'N√£o informado' : 'N√£o encontrado'}
Telefone: ${cliente ? cliente.telefone || 'N√£o informado' : 'N√£o encontrado'}
Email: ${cliente ? cliente.email || 'N√£o informado' : 'N√£o encontrado'}
Endere√ßo: ${cliente ? cliente.endereco || 'N√£o informado' : 'N√£o encontrado'}

==============================
ANDAMENTOS (${andamentos.length})
==============================

`;

            if (andamentos.length === 0) {
                conteudo += 'Nenhum andamento cadastrado para este processo.';
            } else {
                andamentos.forEach((andamento, index) => {
                    conteudo += `ANDAMENTO ${index + 1}:
Data: ${andamento.data}
Tipo: ${andamento.tipo}
Descri√ß√£o: ${andamento.descricao}
Data Registro: ${andamento.dataRegistro}

`;
                });
            }

            abrirModalDetalhes(`Processo: ${processo.numero}`, conteudo);
        }

        function limparConsultas() {
            document.getElementById('resultados-consulta-clientes').innerHTML = '';
            document.getElementById('resultados-consulta-processos').innerHTML = '';
            document.getElementById('consulta-cliente').value = '';
            document.getElementById('consulta-processo').value = '';
        }

        // ========== FUN√á√ïES DE RELAT√ìRIOS ==========
        function atualizarRelatorios() {
            const clientesAtivos = DB.clientes.filter(c => c.status === 'Ativo').length;
            const processosAtivos = DB.processos.filter(p => p.status === 'Ativo').length;
            
            document.getElementById('rel-clientes-ativos').textContent = clientesAtivos;
            document.getElementById('rel-processos-ativos').textContent = processosAtivos;
        }

        function gerarRelatorioClientesAlfabetico() {
            const clientesOrdenados = [...DB.clientes].sort((a, b) => a.nome.localeCompare(b.nome));
            exibirRelatorio(clientesOrdenados, 'clientes-alfabetico');
        }

        function gerarRelatorioClientesProcesso() {
            const clientesComProcessos = DB.clientes.map(cliente => {
                const processos = DB.processos.filter(p => p.clienteCodigo === cliente.codigo);
                return {
                    ...cliente,
                    quantidadeProcessos: processos.length
                };
            }).filter(cliente => cliente.quantidadeProcessos > 0)
              .sort((a, b) => b.quantidadeProcessos - a.quantidadeProcessos);
            
            exibirRelatorio(clientesComProcessos, 'clientes-processo');
        }

        function gerarRelatorioClienteEspecifico() {
            const busca = document.getElementById('relatorio-cliente-especifico').value;
            
            if (!busca) {
                alert('Digite um c√≥digo ou CPF para buscar!');
                return;
            }
            
            const resultados = buscarPorCodigoParcial(busca, 'cliente');
            
            if (resultados.length === 0) {
                alert('Cliente n√£o encontrado!');
                return;
            }
            
            if (resultados.length === 1) {
                const cliente = resultados[0];
                const processos = DB.processos.filter(p => p.clienteCodigo === cliente.codigo);
                const andamentos = DB.andamentos.filter(a => a.clienteCodigo === cliente.codigo);
                
                const relatorio = {
                    cliente: cliente,
                    processos: processos,
                    andamentos: andamentos
                };
                
                exibirRelatorio(relatorio, 'cliente-especifico');
            } else {
                let lista = 'Clientes encontrados:\n\n';
                resultados.forEach((cliente, index) => {
                    lista += `${index + 1}. ${cliente.codigo} - ${cliente.nome}`;
                    if (cliente.cpf) lista += ` (CPF: ${cliente.cpf})`;
                    lista += '\n';
                });
                
                const escolha = prompt(`${lista}\n\nDigite o n√∫mero do cliente desejado:`);
                if (escolha && !isNaN(escolha)) {
                    const index = parseInt(escolha) - 1;
                    if (index >= 0 && index < resultados.length) {
                        const cliente = resultados[index];
                        const processos = DB.processos.filter(p => p.clienteCodigo === cliente.codigo);
                        const andamentos = DB.andamentos.filter(a => a.clienteCodigo === cliente.codigo);
                        
                        const relatorio = {
                            cliente: cliente,
                            processos: processos,
                            andamentos: andamentos
                        };
                        
                        exibirRelatorio(relatorio, 'cliente-especifico');
                    }
                }
            }
        }

        function gerarRelatorioProcessosDetalhado() {
            const processosComCliente = DB.processos.map(processo => {
                const cliente = DB.clientes.find(c => c.codigo === processo.clienteCodigo);
                return {
                    ...processo,
                    clienteNome: cliente ? cliente.nome : 'Cliente n√£o encontrado'
                };
            });
            
            exibirRelatorio(processosComCliente, 'processos-detalhados');
        }

        function exibirRelatorio(dados, tipo) {
            const container = document.getElementById('relatorio-conteudo');
            let conteudo = '';
            
            switch(tipo) {
                case 'processos-detalhados':
                    conteudo = `RELAT√ìRIO DE PROCESSOS DETALHADOS
Data: ${getDataAtualBR()}
Total de processos: ${dados.length}

`;
                    dados.forEach((processo, index) => {
                        const andamentosCount = DB.andamentos.filter(a => a.processoId === processo.id).length;
                        conteudo += `PROCESSO ${index + 1}:
N√∫mero: ${processo.numero}
Tipo: ${processo.tipo}
Cliente: ${processo.clienteNome} (${processo.clienteCodigo})
Local: ${processo.local || 'N√£o informado'}
Data: ${processo.data}
Valor: R$ ${processo.valor.toFixed(2)}
Status: ${processo.status}
Andamentos: ${andamentosCount}
Resumo: ${processo.resumo || 'Sem descri√ß√£o'}
Data Cadastro: ${processo.dataCadastro}

`;
                    });
                    break;
                    
                case 'clientes-alfabetico':
                    conteudo = `RELAT√ìRIO DE CLIENTES (ORDEM ALFAB√âTICA)
Data: ${getDataAtualBR()}
Total de clientes: ${dados.length}

`;
                    dados.forEach((cliente, index) => {
                        const processosCount = DB.processos.filter(p => p.clienteCodigo === cliente.codigo).length;
                        conteudo += `CLIENTE ${index + 1}:
C√≥digo: ${cliente.codigo}
Nome: ${cliente.nome}
CPF: ${cliente.cpf || 'N√£o informado'}
Telefone: ${cliente.telefone || 'N√£o informado'}
Email: ${cliente.email || 'N√£o informado'}
Endere√ßo: ${cliente.endereco || 'N√£o informado'}
Processos: ${processosCount}
Data Cadastro: ${cliente.dataCadastro}
Status: ${cliente.status}

`;
                    });
                    break;
                    
                case 'clientes-processo':
                    conteudo = `RELAT√ìRIO DE CLIENTES POR QUANTIDADE DE PROCESSOS
Data: ${getDataAtualBR()}
Total de clientes: ${dados.length}

`;
                    dados.forEach((cliente, index) => {
                        conteudo += `CLIENTE ${index + 1}:
C√≥digo: ${cliente.codigo}
Nome: ${cliente.nome}
Processos: ${cliente.quantidadeProcessos}
CPF: ${cliente.cpf || 'N√£o informado'}
Telefone: ${cliente.telefone || 'N√£o informado'}
Data Cadastro: ${cliente.dataCadastro}

`;
                    });
                    break;
                    
                case 'cliente-especifico':
                    const { cliente, processos, andamentos } = dados;
                    conteudo = `RELAT√ìRIO ESPEC√çFICO DO CLIENTE
Data: ${getDataAtualBR()}

DADOS PESSOAIS:
C√≥digo: ${cliente.codigo}
Nome: ${cliente.nome}
CPF: ${cliente.cpf || 'N√£o informado'}
RG: ${cliente.rg || 'N√£o informado'}
Sexo: ${cliente.sexo || 'N√£o informado'}
Telefone: ${cliente.telefone || 'N√£o informado'}
Email: ${cliente.email || 'N√£o informado'}
Endere√ßo: ${cliente.endereco || 'N√£o informado'}
Observa√ß√µes: ${cliente.observacoes || 'Nenhuma'}
Data Cadastro: ${cliente.dataCadastro}
Status: ${cliente.status}

PROCESSOS (${processos.length}):
`;

                    if (processos.length === 0) {
                        conteudo += 'Nenhum processo cadastrado.\n\n';
                    } else {
                        processos.forEach((processo, index) => {
                            conteudo += `PROCESSO ${index + 1}:
N√∫mero: ${processo.numero}
Tipo: ${processo.tipo}
Local: ${processo.local || 'N√£o informado'}
Data: ${processo.data}
Valor: R$ ${processo.valor.toFixed(2)}
Status: ${processo.status}
Resumo: ${processo.resumo || 'Sem descri√ß√£o'}

`;
                        });
                    }

                    conteudo += `ANDAMENTOS (${andamentos.length}):
`;

                    if (andamentos.length === 0) {
                        conteudo += 'Nenhum andamento cadastrado.';
                    } else {
                        andamentos.forEach((andamento, index) => {
                            conteudo += `ANDAMENTO ${index + 1}:
Processo: ${andamento.processoNumero}
Data: ${andamento.data}
Tipo: ${andamento.tipo}
Descri√ß√£o: ${andamento.descricao}
Data Registro: ${andamento.dataRegistro}

`;
                        });
                    }
                    break;
            }
            
            container.innerHTML = `
                <div class="card">
                    <h4>üìä Relat√≥rio Gerado</h4>
                    <pre style="font-family: 'Courier New', monospace; font-size: 12px; white-space: pre-wrap; background: #f8f9fa; padding: 15px; border-radius: 5px; max-height: 400px; overflow-y: auto;">${conteudo}</pre>
                </div>
            `;
            
            window.relatorioAtual = { tipo, conteudo, titulo: `Relat√≥rio - ${tipo}` };
        }

        function imprimirRelatorio() {
            if (!window.relatorioAtual || !window.relatorioAtual.conteudo) {
                alert('Gere um relat√≥rio primeiro!');
                return;
            }

            const janelaImpressao = window.open('', '_blank');
            janelaImpressao.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${window.relatorioAtual.titulo}</title>
                    <style>
                        @media print {
                            body { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                line-height: 1.2 !important;
                                padding: 10px !important;
                                background: white !important;
                                color: black !important;
                            }
                            h1 { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 14pt !important;
                                margin: 5px 0 10px 0 !important;
                                text-align: center !important;
                            }
                            pre { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 9pt !important;
                                white-space: pre-wrap !important;
                                background: white !important;
                                border: 1px solid #000 !important;
                                padding: 8px !important;
                                margin: 5px 0 !important;
                                page-break-inside: avoid !important;
                            }
                            .no-print { display: none !important; }
                            @page {
                                margin: 1cm !important;
                            }
                        }
                        body { 
                            font-family: 'Courier New', monospace;
                            font-size: 12pt;
                            padding: 20px;
                        }
                        h1 { 
                            text-align: center;
                            margin-bottom: 20px;
                            border-bottom: 2px solid #000;
                            padding-bottom: 10px;
                        }
                        pre {
                            white-space: pre-wrap;
                            background: #f8f9fa;
                            padding: 15px;
                            border-radius: 5px;
                            border-left: 4px solid #2F5496;
                        }
                    </style>
                </head>
                <body>
                    <h1>${window.relatorioAtual.titulo}</h1>
                    <pre>${window.relatorioAtual.conteudo}</pre>
                    <div class="no-print" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
                        <button onclick="window.print()" style="background: #2F5496; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üñ®Ô∏è Imprimir</button>
                        <button onclick="window.close()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">‚úñ Fechar</button>
                </body>
                </html>
            `);
            janelaImpressao.document.close();
        }

        // ========== FUN√á√ïES DE TESES ==========
        function carregarTeses() {
            ['inicial', 'impugnacao', 'recurso'].forEach(tipo => {
                const select = document.getElementById(`tese-${tipo}`);
                if (select) {
                    select.innerHTML = '<option value="">Selecione uma tese</option>' +
                        Object.keys(DB.teses[tipo] || {}).map(nome => 
                            `<option value="${nome}">${nome}</option>`
                        ).join('');
                }
            });
        }

        function mostrarFormularioTese(tipo) {
            const select = document.getElementById(`tese-${tipo}`);
            const formulario = document.getElementById(`formulario-tese-${tipo}`);
            const textarea = document.getElementById(`conteudo-tese-${tipo}`);
            
            if (select.value) {
                formulario.style.display = 'block';
                textarea.value = DB.teses[tipo][select.value] || '';
            } else {
                formulario.style.display = 'none';
            }
        }

        function salvarTese(tipo) {
            const select = document.getElementById(`tese-${tipo}`);
            const textarea = document.getElementById(`conteudo-tese-${tipo}`);
            
            if (!select.value) {
                alert('Selecione uma tese para salvar');
                return;
            }
            
            if (!DB.teses[tipo]) DB.teses[tipo] = {};
            DB.teses[tipo][select.value] = textarea.value;
            DB.salvar();
            
            alert(`Tese "${select.value}" salva com sucesso!`);
        }

        // ========== FUN√á√ïES PARA MODAL DE TESE ==========
        function carregarTeseModal(tipo) {
            const select = document.getElementById(`tese-${tipo}`);
            const teseNome = select.value;
            
            if (!teseNome) {
                alert('Selecione uma tese para visualizar');
                return;
            }
            
            const conteudo = DB.teses[tipo][teseNome] || '';
            
            if (!conteudo.trim()) {
                alert('Esta tese est√° vazia. Por favor, adicione conte√∫do primeiro.');
                return;
            }
            
            document.getElementById('modal-tese-titulo').textContent = teseNome;
            document.getElementById('modal-tese-conteudo').textContent = conteudo;
            document.getElementById('modalTese').style.display = 'flex';
            
            window.teseAtual = { tipo, nome: teseNome };
        }
        
        function fecharModalTese() {
            document.getElementById('modalTese').style.display = 'none';
            window.teseAtual = null;
        }
        
        function copiarTeseModal() {
            const conteudo = document.getElementById('modal-tese-conteudo').textContent;
            
            if (!conteudo.trim()) {
                mostrarFeedback('‚ùå Tese vazia!', 'danger');
                return;
            }
            
            navigator.clipboard.writeText(conteudo).then(() => {
                mostrarFeedback('‚úÖ Tese copiada para a √°rea de transfer√™ncia!', 'success');
            }).catch(err => {
                console.error('Erro ao copiar:', err);
                mostrarFeedback('‚ùå Erro ao copiar. Tente manualmente.', 'danger');
            });
        }
        
        function imprimirTeseModal() {
            const conteudo = document.getElementById('modal-tese-conteudo').textContent;
            const titulo = document.getElementById('modal-tese-titulo').textContent;
            
            const janelaImpressao = window.open('', '_blank');
            janelaImpressao.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Tese: ${titulo}</title>
                    <style>
                        @media print {
                            body { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                line-height: 1.2 !important;
                                padding: 10px !important;
                                background: white !important;
                                color: black !important;
                            }
                            h1 { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 14pt !important;
                                margin: 5px 0 10px 0 !important;
                            }
                            pre { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                white-space: pre-wrap !important;
                                background: white !important;
                                border: 1px solid #000 !important;
                                padding: 10px !important;
                                margin: 5px 0 !important;
                            }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <h1>${titulo}</h1>
                    <pre>${conteudo}</pre>
                    <div class="no-print" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
                        <button onclick="window.print()" style="background: #2F5496; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üñ®Ô∏è Imprimir</button>
                        <button onclick="window.close()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">‚úñ Fechar</button>
                    </div>
                </body>
                </html>
            `);
            janelaImpressao.document.close();
        }
        
        function mostrarFeedback(mensagem, tipo) {
            const feedbackAnterior = document.querySelector('.feedback-copia');
            if (feedbackAnterior) {
                feedbackAnterior.remove();
            }
            
            const feedback = document.createElement('div');
            feedback.className = `feedback-copia ${tipo === 'success' ? 'feedback-success' : 'feedback-danger'}`;
            feedback.innerHTML = `
                ${tipo === 'success' ? '‚úÖ' : '‚ùå'} ${mensagem}
            `;
            
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => feedback.remove(), 300);
            }, 3000);
        }

        function excluirTese(tipo) {
            const select = document.getElementById(`tese-${tipo}`);
            
            if (!select.value) {
                alert('Selecione uma tese para excluir');
                return;
            }
            
            if (confirm(`Tem certeza que deseja excluir a tese "${select.value}"?`)) {
                delete DB.teses[tipo][select.value];
                DB.salvar();
                carregarTeses();
                document.getElementById(`formulario-tese-${tipo}`).style.display = 'none';
                alert(`Tese "${select.value}" exclu√≠da com sucesso!`);
            }
        }

        function criarNovaTese() {
            const nome = document.getElementById('nova-tese-nome').value;
            const tipo = document.getElementById('nova-tese-tipo').value;
            
            if (!nome) {
                alert('Digite o nome da nova tese');
                return;
            }
            
            if (!DB.teses[tipo]) DB.teses[tipo] = {};
            
            if (DB.teses[tipo][nome]) {
                alert('J√° existe uma tese com este nome');
                return;
            }
            
            DB.teses[tipo][nome] = '';
            DB.salvar();
            carregarTeses();
            
            document.getElementById(`tese-${tipo}`).value = nome;
            mostrarFormularioTese(tipo);
            
            document.getElementById('nova-tese-nome').value = '';
            alert(`Nova tese "${nome}" criada com sucesso!`);
        }

        function carregarTesesDireita() {
            carregarTeses();
        }

        function carregarTesesParaConsulta() {
            const tipo = document.getElementById('tipo-tese-consulta').value;
            const select = document.getElementById('tese-consulta');
            
            select.innerHTML = '<option value="">Selecione uma tese</option>';
            
            if (tipo && DB.teses[tipo]) {
                Object.keys(DB.teses[tipo]).forEach(nome => {
                    select.innerHTML += `<option value="${nome}">${nome}</option>`;
                });
            }
        }

        function mostrarTeseSelecionada() {
            const tipo = document.getElementById('tipo-tese-consulta').value;
            const nome = document.getElementById('tese-consulta').value;
            const container = document.getElementById('tese-exibicao');
            
            if (tipo && nome && DB.teses[tipo] && DB.teses[tipo][nome]) {
                document.getElementById('titulo-tese').textContent = nome;
                document.getElementById('conteudo-tese-consulta').textContent = DB.teses[tipo][nome];
                container.style.display = 'block';
            } else {
                container.style.display = 'none';
            }
        }

        function copiarTeseConsulta() {
            const conteudo = document.getElementById('conteudo-tese-consulta').textContent;
            navigator.clipboard.writeText(conteudo).then(() => {
                alert('Tese copiada para a √°rea de transfer√™ncia!');
            });
        }

        function imprimirTese() {
            const titulo = document.getElementById('titulo-tese').textContent;
            const conteudo = document.getElementById('conteudo-tese-consulta').textContent;
            
            const janelaImpressao = window.open('', '_blank');
            janelaImpressao.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Tese: ${titulo}</title>
                    <style>
                        @media print {
                            body { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                line-height: 1.2 !important;
                                padding: 10px !important;
                                background: white !important;
                                color: black !important;
                            }
                            h1 { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 14pt !important;
                                margin: 5px 0 10px 0 !important;
                            }
                            pre { 
                                font-family: 'Courier New', monospace !important;
                                font-size: 10pt !important;
                                white-space: pre-wrap !important;
                                background: white !important;
                                border: 1px solid #000 !important;
                                padding: 10px !important;
                                margin: 5px 0 !important;
                            }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <h1>${titulo}</h1>
                    <pre>${conteudo}</pre>
                    <div class="no-print" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
                        <button onclick="window.print()" style="background: #2F5496; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üñ®Ô∏è Imprimir</button>
                        <button onclick="window.close()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">‚úñ Fechar</button>
                    </div>
                </body>
                </html>
            `);
            janelaImpressao.document.close();
        }

        // ========== FUN√á√ïES DE BACKUP ==========
        function exportBackupClientes() {
            const backup = {
                clientes: DB.clientes,
                processos: DB.processos,
                andamentos: DB.andamentos,
                dataBackup: getDataAtualBR(),
                versao: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-clientes-${getDataAtualBR().replace(/\//g, '-')}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Backup de clientes exportado com sucesso!');
        }

        function importBackupClientes() {
            document.getElementById('backup-file-clientes').click();
        }

        function exportBackupTeses() {
            const backup = {
                teses: DB.teses,
                dataBackup: getDataAtualBR(),
                versao: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-teses-${getDataAtualBR().replace(/\//g, '-')}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Backup de teses exportado com sucesso!');
        }

        function importBackupTeses() {
            document.getElementById('backup-file-teses').click();
        }

        function processarBackup(event, tipo) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backup = JSON.parse(e.target.result);
                    
                    if (confirm(`‚ö†Ô∏è Isso substituir√° todos os dados ${tipo === 'clientes' ? 'de clientes e processos' : 'de teses'} atuais. Continuar?`)) {
                        if (tipo === 'clientes') {
                            DB.clientes = backup.clientes || [];
                            DB.processos = backup.processos || [];
                            DB.andamentos = backup.andamentos || [];
                            alert('Backup de clientes importado com sucesso!');
                        } else if (tipo === 'teses') {
                            DB.teses = backup.teses || { inicial: {}, impugnacao: {}, recurso: {} };
                            alert('Backup de teses importado com sucesso!');
                        }
                        
                        DB.salvar();
                        event.target.value = '';
                    }
                } catch (error) {
                    alert('Erro ao importar backup. Arquivo inv√°lido.');
                    console.error('Erro ao importar backup:', error);
                }
            };
            reader.readAsText(file);
        }

        // ========== FUN√á√ïES DO SISTEMA ==========
        function atualizarEstatisticas() {
            const statsContainer = document.getElementById('stats-container');
            const processosContainer = document.getElementById('processos-container');
            
            if (statsContainer) {
                statsContainer.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${DB.clientes.length}</div>
                        <p>Clientes Cadastrados</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${DB.processos.length}</div>
                        <p>Total de Processos</p>
                    </div>
                `;
            }
            
            if (processosContainer) {
                const areas = ['Trabalhista', 'C√≠vel', 'Consumidor', 'Previdenci√°rio', 'Fam√≠lia', 'Criminal', 'Outros'];
                processosContainer.innerHTML = areas.map(area => {
                    const count = DB.processos.filter(p => p.tipo === area).length;
                    return `
                        <div class="processo-card">
                            <div class="processo-number">${count}</div>
                            <p>${area}</p>
                        </div>
                    `;
                }).join('');
            }
        }

        function verDetalhesProcesso(id) {
            const processo = DB.processos.find(p => p.id === id);
            if (!processo) return;

            const andamentos = DB.andamentos.filter(a => a.processoId === id);
            
            let html = `
                <div class="card">
                    <h3>üìã Detalhes do Processo</h3>
                    <div class="data-item">
                        <strong>N√∫mero: ${processo.numero}</strong><br>
                        <strong>Cliente: ${processo.clienteNome}</strong><br>
                        Tipo: ${processo.tipo}<br>
                        Local: ${processo.local || 'N√£o informado'}<br>
                        Data: ${processo.data}<br>
                        Valor: R$ ${processo.valor.toFixed(2)}<br>
                        Status: ${processo.status}<br>
                        Resumo: ${processo.resumo || 'Sem descri√ß√£o'}
                    </div>
                    
                    <h4 style="margin-top: 20px;">üìù Andamentos</h4>
            `;

            if (andamentos.length > 0) {
                andamentos.forEach(andamento => {
                    html += `
                        <div class="data-item">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>${andamento.tipo}</strong>
                                <small>${andamento.data}</small>
                            </div>
                            <div>${andamento.descricao}</div>
                        </div>
                    `;
                });
            } else {
                html += '<div class="data-item">Nenhum andamento registrado.</div>';
            }

            html += `
                    <div style="margin-top: 20px;">
                        <div class="btn-row">
                            <button class="btn btn-danger" onclick="excluirProcesso('${processo.id}')">üóëÔ∏è Excluir Processo</button>
                            <button class="btn" onclick="showTab('processos')">‚Üê Voltar</button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('lista-processos-direita').innerHTML = html;
        }

        function executarAutoReparo() {
            if (confirm('üõ†Ô∏è Executar sistema de auto-reparo?\n\nIsso ir√° verificar e corrigir poss√≠veis problemas no banco de dados.')) {
                let reparos = 0;
                
                DB.clientes = DB.clientes.filter(cliente => 
                    cliente && cliente.codigo && cliente.nome
                );
                
                DB.processos = DB.processos.filter(processo => 
                    processo && processo.id && processo.numero && processo.tipo
                );
                
                DB.andamentos = DB.andamentos.filter(andamento => 
                    andamento && andamento.id && andamento.descricao
                );
                
                if (!DB.teses) DB.teses = { inicial: {}, impugnacao: {}, recurso: {} };
                if (!DB.teses.inicial) DB.teses.inicial = {};
                if (!DB.teses.impugnacao) DB.teses.impugnacao = {};
                if (!DB.teses.recurso) DB.teses.recurso = {};
                
                DB.salvar();
                alert(`Sistema verificado e reparado com sucesso! ${reparos} reparos realizados.`);
            }
        }

        function atualizarSistema() {
            DB.atualizarInterface();
            alert('Sistema atualizado!');
        }

        // ========== INICIALIZA√á√ÉO ==========
        function inicializarSistema() {
            if (document.getElementById('inputSenha')) {
                document.getElementById('inputSenha').addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        verificarSenha();
                    }
                });
            }
            
            document.getElementById('backup-file-clientes').addEventListener('change', (event) => processarBackup(event, 'clientes'));
            document.getElementById('backup-file-teses').addEventListener('change', (event) => processarBackup(event, 'teses'));
            
            document.getElementById('propagandaContainer').style.display = 'block';
            
            document.getElementById('modalDetalhes')?.addEventListener('click', function(event) {
                if (event.target === this) {
                    fecharModalDetalhes();
                }
            });
            
            document.getElementById('modalTese')?.addEventListener('click', function(event) {
                if (event.target === this) {
                    fecharModalTese();
                }
            });
            
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    fecharModalDetalhes();
                    fecharModalTese();
                }
            });
            
            atualizarEstatisticas();
            atualizarPropagandas();
            
            console.log('üöÄ Sistema Jur√≠dico Completo carregado com sucesso!');
        }

        // ========== INICIAR SISTEMA ==========
        document.addEventListener('DOMContentLoaded', verificarRegistro);
    </script>
</body>
</html>
